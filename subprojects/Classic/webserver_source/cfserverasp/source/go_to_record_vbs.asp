<%' Copyright 1999-2003 CambridgeSoft Corporation. All rights reserved
'DO NOT EDIT THIS FILE%>

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<title>Go To Record</title>
<%dbkey = Request.QueryString("dbname")
totalrecords  = request.querystring("total_records")
if totalrecords = "" then
totalrecords = Session("totalrecordsCur")
end if%>
<script language="javascript">
//var totalrecords = ""
okhelpstr = "submit record request"
cancelhelpstr = "close window"
theOpener = opener
var temp = "<%=totalrecords%>"
totalrecords = new Number(temp)

function getButtons() {
	outputval = ""
	var buttonGifPath = theOpener.button_gif_path 
	okbutton = buttonGifPath + "ok.gif"
	cancelbutton = buttonGifPath + "Cancel.gif"
	outputval = '<A HREF = "javascript:checkVal();" onMouseOver="window.status=&quot;' + okhelpstr + '&quot;; return true;"><IMG SRC="' +  okbutton + '" BORDER="0"></A>'
	outputval = outputval + '<A HREF = "javascript:window.close();" onMouseOver="window.status=&quot;' + cancelhelpstr + '&quot;; return true;"><IMG SRC="' +  cancelbutton + '" BORDER="0"></A>'	
	document.write (outputval)
	}


function checkVal(){

theVal = document.gotoRecord.gotovalue.value
correctInput = isEmpty(theVal)
correctNum = isPosInteger(theVal)
correctRange = inRange(theVal)
	
	if (correctNum && correctRange && correctInput){
		theOpener.submitGotoValue(theVal)
		window.close()
	}	
	else
	{
		alert("Please enter a positive value between 1 and " + totalrecords)
		<%Session("totalrecordsCur") = totalrecords%>
	}
}

// check if a field is empty
function isEmpty(inputVal){
	if(inputVal == "" || inputVal == null){
		return false
	}
	return true
}
function inRange(inputVal){
	if (inputVal.length > 0){
		if ((inputVal <= 0) || (inputVal > totalrecords)){
			return false
		}
		return true
	}
	return false
}
	 
	

function isPosInteger(inputVal){
	if (inputVal.length > 0){
		inputStr = inputVal.toString()		
		for(var i=0; i<inputStr.length; i++){
			var oneChar = inputStr.charAt(i)
			if(i == 0 && oneChar == "-"){
				return false
			}				
			if(oneChar < "0" || oneChar > "9") {
				return false
			}
		}	
	return true	
	}
return false	
}
</script>
</head>

<body>

<form name="gotoRecord" onSubmit = "checkVal()">
  <script language="javascript">getButtons()</script>
<table border="1" width="100%">
    <tr>
      <td><small><font face="Arial"><script language="javascript">document.write('Please enter a number between 1 and ' +  totalrecords)</script></font></small> <input
      type="text" name="gotovalue" value size="10"></td>
    </tr>
  </table>
</form>
</body>
</html>
