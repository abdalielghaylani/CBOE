<%@ EnableSessionState=False Language=VBScript%>
<!--#INCLUDE VIRTUAL = "/cfserverasp/source/ado.inc"-->
<!--#INCLUDE VIRTUAL = "/cfserverasp/source/server_const_vbs.asp"-->
<!--#INCLUDE VIRTUAL = "/cheminv/api/apiUtils.asp"-->
<Script RUNAT="Server" Language="VbScript">
Dim LocationID
Dim ContainerID
Dim Conn
Dim Cmd

Dim strError
Dim bWriteError
Response.Expires = -1
bDebugPrint = False
bWriteError = False
strError = "Error:CertifyContainer<BR>"

ContainerID = Request("ContainerID")
StatusIDFK = Request("StatusIDFK")
Purity = Request("Purity")
Interval = Request("Interval")
StorageConditions = Request("StorageConditions")
HandlingProcedures = Request("HandlingProcedures")

' Redirect to help page if no parameters are passed
if Len(Request.QueryString) = 0 AND Len(Request.Form)= 0 then
	Response.Redirect "/cheminv/help/admin/api/CertifyContainer.htm"
	Response.end
End if

' Check for required parameters
if IsEmpty(ContainerID) then
	strError = strError & "ContainerID is a required parameter<BR>"
	bWriteError = True
End if
if IsEmpty(StatusIDFK) then
	strError = strError & "StatusIDFK is a required parameter<BR>"
	bWriteError = True
End if

' Respond with Error
if bWriteError then
	Response.Write strError
	Response.end
End if

' Initialize optional parameters
if Purity = "" then Purity = NULL
if Interval = "" then Interval = NULL

' Set up and ADO command
Call GetInvCommand(Application("CHEMINV_USERNAME") & ".CertifyContainer", adCmdStoredProc)

' Code generated by QueryProcParams.asp helper page
Cmd.Parameters.Append Cmd.CreateParameter("RETURN_VALUE",adVarchar, adParamReturnValue, 200, NULL)
Cmd.Parameters.Append Cmd.CreateParameter("PCONTAINERID",adNumeric, 1, 0, ContainerID)
Cmd.Parameters("PCONTAINERID").Precision = 9
Cmd.Parameters.Append Cmd.CreateParameter("PSTATUSIDFK",adNumeric, 1, 0, StatusIDFK)
Cmd.Parameters.Append Cmd.CreateParameter("PPURITY",adNumeric, 1, 0, Purity)
Cmd.Parameters.Append Cmd.CreateParameter("PINTERVAL",adNumeric, 1, 0, Interval)
Cmd.Parameters.Append Cmd.CreateParameter("PSTORAGECONDITIONS", 200, 1, 2000, StorageConditions)
Cmd.Parameters.Append Cmd.CreateParameter("PHANDLINGPROCEDURES", 200, 1, 2000, HandlingProcedures)
if bDebugPrint then
	For each p in Cmd.Parameters
		Response.Write p.name & " = " & p.value & "<BR>"
	Next	
Else
	Call ExecuteCmd(Application("CHEMINV_USERNAME") & ".CertifyContainer")
End if

' Return
Response.Write Cmd.Parameters("RETURN_VALUE")

'Clean up
Conn.Close
Set Conn = Nothing
Set Cmd = Nothing
</SCRIPT>
