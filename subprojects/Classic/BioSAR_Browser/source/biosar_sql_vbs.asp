<%' Copyright 1999-2003 CambridgeSoft Corporation. All rights reserved
'DO NOT EDIT THIS FILE%>
<%

'**************************************************
Function getSchemaPrefix()
	SCHEMA = "BIOSARDB"
	If SCHEMA <> "" then
		FINAL_QUALIFIED_NAME = SCHEMA & "." 
	else
		FINAL_QUALIFIED_NAME = ""
	end if
	getSchemaPrefix = FINAL_QUALIFIED_NAME
End Function 


Function GetTableInfofromFormGroup(formgroup)
		'sql = "Select " & getSchemaPrefix() & "DB_TABLE.* " &_
		'	" FROM  "&_
		'	getSchemaPrefix() & "DB_TABLE," & getSchemaPrefix() & "DB_FORMGROUP "  &_
		'	" WHERE " &_
		'	getSchemaPrefix() & "DB_TABLE.TABLE_ID = " & getSchemaPrefix() & "DB_FORMGROUP.BASE_TABLE_ID AND " &_
		'	getSchemaPrefix() & "DB_FORMGROUP.FORMGROUP_ID =" & formgroup 
			
			sql = "Select dbt.* " &_
			" FROM  "&_
			getSchemaPrefix() & "DB_TABLE dbt," & getSchemaPrefix() & "DB_FORMGROUP "  &_
			" WHERE dbt.TABLE_ID = " & getSchemaPrefix() & "DB_FORMGROUP.BASE_TABLE_ID AND " &_
			getSchemaPrefix() & "DB_FORMGROUP.FORMGROUP_ID =" & formgroup 
						
		GetTableInfofromFormGroup = sql
End Function

Function GetSQLTableOrderFromFormGroup(formgroup)
		'sql = "Select DISTINCT " & getSchemaPrefix() & "DB_TABLE.TABLE_NAME " &_
		'" from " &_
		'	getSchemaPrefix() & "DB_FORM," & getSchemaPrefix() & "DB_FORM_ITEM," & getSchemaPrefix() & "DB_TABLE " &_
		'" WHERE " &_
		'	getSchemaPrefix() & "DB_FORM_ITEM.FORM_ID = " & getSchemaPrefix() & "DB_FORM.FORM_ID AND  " &_
		'	getSchemaPrefix() & "DB_FORM_ITEM.TABLE_ID = " & getSchemaPrefix() & "DB_TABLE.TABLE_ID   AND   " &_
		'	getSchemaPrefix() & "DB_FORM.FORMGROUP_ID=" & formgroup 
		'GetSQLTableOrderFromFormGroup=sql


		sql = "Select DISTINCT dbt.TABLE_NAME " &_
		" from " &_
			getSchemaPrefix() & "DB_FORM dbf," & getSchemaPrefix() & "DB_FORM_ITEM dbfi," & getSchemaPrefix() & "DB_TABLE dbt " &_
		" WHERE " &_
			"dbfi.FORM_ID = dbf.FORM_ID AND  " &_
			"dbfi.TABLE_ID = dbt.TABLE_ID  AND   " &_
			"dbf.FORMGROUP_ID=" & formgroup 
		GetSQLTableOrderFromFormGroup=sql
		
End Function

Function GetSQLTableAndNamesFromFormGroup(formgroup)
		sql = "Select DISTINCT dbt.* " &_
		" from " &_
			getSchemaPrefix() & "DB_FORM dbf," & getSchemaPrefix() & "DB_FORM_ITEM dbfi," & getSchemaPrefix() & "DB_TABLE dbt" &_
		" WHERE " &_
			"dbfi.FORM_ID = dbf.FORM_ID AND  " &_
			"dbfi.TABLE_ID = dbt.TABLE_ID   AND   " &_
			"dbf.FORMGROUP_ID=" & formgroup & "  AND  " &_
			"dbf.FORMTYPE_ID=1"
		GetSQLTableAndNamesFromFormGroup=sql
		'sql = "Select DISTINCT " & getSchemaPrefix() & "DB_TABLE.* " &_
		'" from " &_
		'	getSchemaPrefix() & "DB_FORM," & getSchemaPrefix() & "DB_FORM_ITEM," & getSchemaPrefix() & "DB_TABLE " &_
		'" WHERE " &_
		'	getSchemaPrefix() & "DB_FORM_ITEM.FORM_ID = " & getSchemaPrefix() & "DB_FORM.FORM_ID AND  " &_
		'	getSchemaPrefix() & "DB_FORM_ITEM.TABLE_ID = " & getSchemaPrefix() & "DB_TABLE.TABLE_ID   AND   " &_
		'	getSchemaPrefix() & "DB_FORM.FORMGROUP_ID=" & formgroup & "  AND  " &_
		'	getSchemaPrefix() & "DB_FORM.FORMTYPE_ID=1"
		'GetSQLTableAndNamesFromFormGroup=sql
End Function

Function getColumnInfoFromColumnID(column_id)
		'sql = "Select " & getSchemaPrefix() & "DB_COLUMN.* from " & getSchemaPrefix() & "DB_COLUMN where " &_
		'getSchemaPrefix() & "DB_COLUMN.COLUMN_ID = " & column_id
		'getColumnInfoFromColumnID=sql
		sql = "Select dbc.* from " & getSchemaPrefix() & "DB_COLUMN dbc where " &_
		"dbc.COLUMN_ID = " & column_id
		getColumnInfoFromColumnID=sql		
End Function

Function getURLFromFormGroup(formgroup, display_view)
	form_type_id = getDisplayID(display_view)
	sql = "Select URL from " & getSchemaPrefix() & "DB_FORM WHERE FORMGROUP_ID = " & formgroup & " AND " &_
		"" & getSchemaPrefix() & "DB_FORM.FORMTYPE_ID=" & form_type_id
	getURLFromFormGroup = sql
End Function

Function GetAllFormItemsFromFormGroupAndFormType(formgroup, display_view)
		form_type_id = getDisplayID(display_view)
		sql = "Select dbvwfia.* from " & getSchemaPrefix() & "DB_VW_FORMITEMS_ALL dbvwfia " &_
		" where " &_
		"dbvwfia.FORMGROUP_ID=" & formgroup & " AND " &_
		"dbvwfia.FORMTYPE_ID=" & form_type_id & " ORDER BY TABLE_ORDER,COLUMN_ORDER"

	GetAllFormItemsFromFormGroupAndFormType=sql
End Function

Function GetAllColFromFormGroupForTableAndDisplayType(formgroup, display_view, table_name)
		form_type_id = getDisplayID(display_view)
		sql = "Select dbvwfia.* FROM " & getSchemaPrefix() & "DB_VW_FORMITEMS_ALL dbvwfia " &_
		" WHERE " &_
		"dbvwfia.FORMGROUP_ID=" & formgroup & " AND " &_
		"dbvwfia.FORMTYPE_ID=" & form_type_id & " AND " &_
		"dbvwfia.TABLE_NAME = '" & table_name & "'"  &_
		" ORDER BY Column_Order"

	GetAllColFromFormGroupForTableAndDisplayType=sql
End Function
Function GetAllColFromFormGroupForTableAndDisplayType2(formgroup, display_view, table_name)
		form_type_id = getDisplayID(display_view)
		sql = "Select Distinct dbvwfia.COLUMN_NAME, dbvwfia.DISP_TYP_NAME,dbvwfia.TABLE_NAME,dbvwfia.DISPLAY_NAME FROM " & getSchemaPrefix() & "DB_VW_FORMITEMS_ALL dbvwfia" &_
		" WHERE " &_
		"dbvwfia.FORMGROUP_ID=" & formgroup & " AND " &_
		"dbvwfia.FORMTYPE_ID=" & form_type_id & " AND " &_
		"dbvwfia.TABLE_NAME = '" & table_name & "'"

	GetAllColFromFormGroupForTableAndDisplayType2=sql
End Function
	
Function GetTableIDSfromFromGroup(formgroup)

		sql = "Select DISTINCT dbvwfia.TABLE_ID " &_
		" FROM  "&_
		getSchemaPrefix() & "DB_VW_FORMITEMS_ALL dbvwfia"  &_
		" WHERE " &_
		"dbvwfia.FORMGROUP_ID =" & formgroup 
		
		
		GetTableIDSfromFromGroup=sql
End Function

Function getTableRelFromTableID(table_id)
	 sql ="Select dbr.* from " & getSchemaPrefix() & "DB_RELATIONSHIP dbr Where dbr.CHILD_TABLE_ID = " & table_id
	getTableRelFromTableID = sql
End Function

Function getTableRelFromTableIDForBase(table_id, basetable_id)
	 sql ="Select dbr.* from " & getSchemaPrefix() & "DB_RELATIONSHIP dbr Where dbr.CHILD_TABLE_ID = " & table_id &  " AND dbr.TABLE_ID = " & basetable_id
	getTableRelFromTableIDForBase = sql
End Function

Function getBaseTableRelFromTableID(table_id)
	sql = "Select * from " & getSchemaPrefix() & "DB_TABLE Where " & getSchemaPrefix() & "DB_TABLE.TABLE_ID = " & table_id
	getBaseTableRelFromTableID = sql
End Function
Function getParentTableInfoFromParentTableID(parent_table_id)
		'sql = "Select  " & getSchemaPrefix() & "DB_TABLE.*," & getSchemaPrefix() & "DB_COLUMN.* " &_ 
		'" FROM " &_
		'getSchemaPrefix() & "DB_TABLE," & getSchemaPrefix() & "DB_COLUMN " &_
		'" WHERE " &_
		'getSchemaPrefix() & "DB_TABLE.TABLE_ID = " & getSchemaPrefix() & "DB_COLUMN.TABLE_ID AND " &_
		'"  " & getSchemaPrefix() & "DB_TABLE.TABLE_ID = " & parent_table_id
		'getParentTableInfoFromParentTableID = sql
		sql = "Select dbt.* , dbc.* " &_ 
		" FROM " &_
		getSchemaPrefix() & "DB_TABLE dbt," & getSchemaPrefix() & "DB_COLUMN dbc" &_
		" WHERE " &_
		"dbt.TABLE_ID = dbc.TABLE_ID AND " &_
		"  dbt.TABLE_ID = " & parent_table_id
		getParentTableInfoFromParentTableID = sql
End Function


Function getParentColumnInfoFromParentColID(parent_column_id)
		sql = "Select dbc.* " &_ 
		" FROM " &_
		getSchemaPrefix() & "DB_COLUMN dbc" &_
		" WHERE " &_
		"  dbc.COLUMN_ID = " & parent_column_id
		getParentColumnInfoFromParentColID=sql
End Function

Function getChildTableInfoFromChildTableID(child_table_id)
		sql = "Select  dbt.* " &_ 
		" FROM " &_
		getSchemaPrefix() & "DB_TABLE dbt" &_
		" WHERE " &_
		"  dbt.TABLE_ID = " & child_table_id
		getChildTableInfoFromChildTableID = sql
End Function

Function getChildColumnInfoFromChildColID(child_column_id)
		sql = "Select  dbc.* " &_ 
		" FROM " &_
		getSchemaPrefix() & "DB_COLUMN dbc" &_
		" WHERE " &_
		"dbc.COLUMN_ID = " & child_column_id
		getChildColumnInfoFromChildColID=sql
End Function

Function getAllTableInfoFromTableID(table_id)
		sql = "Select dbvwct.* from " & getSchemaPrefix() & "DB_VW_COLUMN_TABLE dbvwct where dbvwct.TABLE_ID = " & table_id
		getAllTableInfoFromTableID=sql
End Function

Function getColumnNameFromTableID(table_id)
		sql = "Select " & getSchemaPrefix() & "DB_COLUMN.COLUMN_NAME from " & getSchemaPrefix() & "DB_COLUMN," & getSchemaPrefix() & "DB_VW_TABLE_SCHEMA where " &_
		getSchemaPrefix() & "DB_COLUMN.COLUMN_ID = " & getSchemaPrefix() & "DB_VW_TABLE_SCHEMA.BASE_COLUMN_ID AND "  &_
		getSchemaPrefix() & "DB_VW_TABLE_SCHEMA.TABLE_ID =" & table_id
		getColumnNameFromTableID=sql
End Function 

Function getisStrucInTable(table_id)
		sql = "Select column_id from " & getSchemaPrefix() & "DB_VW_COLUMN_TABLE where " &_
		getSchemaPrefix() & "DB_VW_COLUMN_TABLE.TABLE_ID =" & table_id &_
		" AND upper(" & getSchemaPrefix() & "DB_VW_COLUMN_TABLE.INDEX_TYPE_ID) = " & CARTRIDGE_INDEX_TYPE
		
		getisStrucInTable=sql
End Function

Function getMOLIDColumnInfofromTableID(table_id,table_id2)
		sql = "Select COLUMN_ID, COLUMN_NAME,LOOKUP_TABLE_ID from " & getSchemaPrefix() & "DB_VW_COLUMN_TABLE where table_id=" & table_id & " AND LOOKUP_COLUMN_DISPLAY=(" &_
		"Select column_id  from " & getSchemaPrefix() & "DB_VW_COLUMN_TABLE where " &_
		getSchemaPrefix() & "DB_VW_COLUMN_TABLE.TABLE_ID =" & table_id2 &_
		" AND upper(" & getSchemaPrefix() & "DB_VW_COLUMN_TABLE.INDEX_TYPE_ID) = " & CARTRIDGE_INDEX_TYPE & ")"
		
		getMOLIDColumnInfofromTableID=sql
End Function

Function getMOLIDColumnInfofromTableID2(table_id)
		sql = "Select COLUMN_ID, COLUMN_NAME,LOOKUP_TABLE_ID from " & getSchemaPrefix() & "DB_VW_COLUMN_TABLE where table_id=" & table_id  & " AND " & "DB_VW_COLUMN_TABLE.INDEX_TYPE_ID = " & CARTRIDGE_INDEX_TYPE & ""
		
		getMOLIDColumnInfofromTableID2=sql
End Function

Function getDisplayID(display_view)
	Select Case UCase(display_View)
		Case "QUERY"
			form_view_id = "1"
		Case "LIST"
			form_view_id = "2"
		Case "DETAIL"
			form_view_id = "3"
	end select
	getDisplayID =form_view_id
End Function

		
Function getParentRelationshipByParentTableID_old(table_id)
	sql = "SELECT  " & getSchemaPrefix() & "DB_VW_PARENT_TABLES.CHILD_TABLE_ID," & getSchemaPrefix() & "DB_VW_CHILD_TABLES.CHILD_TABLE_NAME FROM " & getSchemaPrefix() & "DB_VW_PARENT_TABLES," & getSchemaPrefix() & "DB_VW_CHILD_TABLES " &_
	" WHERE " & getSchemaPrefix() & "DB_VW_PARENT_TABLES.TABLE_ID = " & getSchemaPrefix() & "DB_VW_CHILD_TABLES.TABLE_ID " &_
	" AND  " & getSchemaPrefix() & "DB_VW_PARENT_TABLES.TABLE_ID = " & table_id
	getParentRelationshipByParentTableID_old = sql
End Function

Function getParentRelationshipByParentTableID(formgroup,table_id)
	sql = "SELECT  " & getSchemaPrefix() & "FORMGROUP_TABLES.FORMGROUP_ID," & getSchemaPrefix() & "DB_RELATIONSHIP.TABLE_ID," & getSchemaPrefix() & "DB_TABLE.TABLE_NAME FROM " & getSchemaPrefix() & "DB_RELATIONSHIP," & getSchemaPrefix() & "DB_TABLE " &_
	" WHERE " & getSchemaPrefix() & "DB_RELATIONSHIP.TABLE_ID = " & getSchemaPrefix() & "DB_TABLE.TABLE_ID " &_
	getSchemaPrefix() & "FORMGROUP_TABLES.TABLE_ID = " & getSchemaPrefix() & "DB_RELATIONSHIP.TABLE_ID " &_
	" AND " & getSchemaPrefix() & "FORMGROUP_TABLES.FORMGROUP_ID=" & formgroup & getSchemaPrefix() & "DB_RELATIONSHIP.CHILD_TABLE_ID = " & table_id  
	getParentRelationshipByParentTableID = sql
End Function

Function GetALLFormGroupTableInfoForFormType()
			sql = "SELECT * from biosardb.DB_FORMGROUP_TABLES where formgroup_id = ? and table_id = ?"
			GetALLFormGroupTableInfoForFormType = sql
			
End Function 
Function GetALLFormGroupTableInOrder()
			sql = "SELECT DISTINCT db_formgroup_tables.table_id, db_formgroup_tables.table_order " &_ 
			" FROM BIOSARDB.db_formgroup_tables " &_ 
			" WHERE db_formgroup_tables.formgroup_id= ?" &_
			" ORDER BY db_formgroup_tables.table_order ASC "
			
			GetALLFormGroupTableInOrder = sql
			
End Function 
Function GetALLFGItemsForFormTypeAndTable(formgroup, form_type_id, table_id)
			sql = "Select * from " & getSchemaPrefix() & "DB_VW_FORMITEMS_ALL," & getSchemaPrefix() & "DB_FORMGROUP_TABLES " &_
			" where " &_
			getSchemaPrefix() & "DB_VW_FORMITEMS_ALL.FORMGROUP_ID=" & formgroup & " AND " &_
			getSchemaPrefix() & "DB_VW_FORMITEMS_ALL.FORMTYPE_ID=" & form_type_id & " AND " &_
			getSchemaPrefix() & "DB_FORMGROUP_TABLES.TABLE_ID=" & getSchemaPrefix() & "DB_VW_FORMITEMS_ALL.TABLE_ID  AND " &_
			getSchemaPrefix() & "DB_VW_FORMITEMS_ALL.TABLE_ID=" & table_id &_
			" ORDER BY " & getSchemaPrefix() & "DB_FORMGROUP_TABLES.TABLE_REL_ORDER ASC," & getSchemaPrefix() & "DB_VW_FORMITEMS_ALL.COLUMN_ORDER ASC"
			GetALLFGItemsForFormTypeAndTable = sql
End Function 

Function getTableName(Table_ID)
	sql ="Select " & getSchemaPrefix() & "DB_TABLE.Table_Name as Table_Name from " & getSchemaPrefix() & "DB_TABLE where " & getSchemaPrefix() & "DB_TABLE.TABLE_ID = " & table_id
	getTableName = sql
End Function

Function getColumnName(Column_ID)
	sql ="Select " & getSchemaPrefix() & "DB_COLUMN.COLUMN_NAME as Column_Name, " & getSchemaPrefix() & "DB_COLUMN.DISPLAY_NAME as Column_Display_Name  from " & getSchemaPrefix() & "DB_COLUMN where " & getSchemaPrefix() & "DB_COLUMN.COLUMN_ID = " & column_id
	getColumnName = sql
End Function

Function getColumnNameParam(Column_ID)
	sql ="Select " & getSchemaPrefix() & "DB_COLUMN.COLUMN_NAME as Column_Name, " & getSchemaPrefix() & "DB_COLUMN.DISPLAY_NAME as Column_Display_Name  from " & getSchemaPrefix() & "DB_COLUMN where " & getSchemaPrefix() & "DB_COLUMN.COLUMN_ID = ?"
	getColumnName = sql
End Function


Function  GetMOLIDLookupINFO(baseTableID)
	sql ="Select * FROM " & getSchemaPrefix() & "DB_COLUMN where " & getSchemaPrefix() & "DB_COLUMN.TABLE_ID=" & baseTableID & " AND DB_COLUMN.COLUMN_NAME='MOL_ID'"

	GetMOLIDLookupINFO = sql
End Function
		


		
%>