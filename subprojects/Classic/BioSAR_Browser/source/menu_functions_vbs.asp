<%'Copyright 1999-2003 CambridgeSoft Corporation. All rights reserved%>
<%'PURPOSE OF FILE: TO add custom vbscript functions to an applciation
'All form files generated by the wizard have a #INCLUDE for this file. Add the #INCLUDE to form files
'that you might add to the application.%>


<%


'Menu Bar hide/dim functions

function HideOrganizeFormgroups()
	dbkey = "biosar_browser"
	if Session("ADD_USER_FORMGROUP" & dbkey)= true then
		thereturn = false
	else
		thereturn = true
	end if 
	HideOrganizeFormgroups = thereturn
end function

function HideOrganizePublicFormgroups()
	dbkey = "biosar_browser"
	if Session("ADD_ADMIN_SCHEMA" & dbkey)= true then
		thereturn = false
	else
		thereturn = true
	end if 
	HideOrganizePublicFormgroups = thereturn
end function

function HideOrganizeProjects()
	dbkey = "biosar_browser"
	if Session("ADD_ADMIN_SCHEMA" & dbkey) then 
		thereturn = false
	else
		thereturn = true
	end if 
	HideOrganizeProjects = thereturn
end function

function dimOrganizeFormgroups()
	if Session("AllowOrganizeFGSubmenu") = true then
		thereturn = false
	else
		thereturn = true
	end if
	Session("AllowOrganizeFGSubmenu")=""
	dimOrganizeFormgroups = thereturn
end function

function dimOrganizePublicFormgroups()
	if Session("AllowOrganizePublicFGSubmenu") = true then
		thereturn = false
	else
		thereturn = true
	end if
	Session("AllowOrganizePublicFGSubmenu")=""
	dimOrganizePublicFormgroups = thereturn
end function

function dimOrganizeProjects()
	if Session("AllowOrganizeProjectsSubmenu") = true then
		thereturn = false
	else
		thereturn = true
	end if 
	Session("AllowOrganizeProjectsSubmenu") =""
	dimOrganizeProjects = thereturn
end function

function dimRestoreFormgroups(dbkey, formgroup)
	if  Session("UserFormgroupsExist") = true then
		thereturn = false
	else
		thereturn = true
	end if 
	dimRestoreFormgroups = thereturn
end function

function dimManageFormgroups(dbkey, formgroup)

	if (Session("ADD_USER_FORMGROUP" & dbkey) or Session("EDIT_USER_FORMGROUP" & dbkey) or  Session("DELETE_USER_FORMGROUP" & dbkey)or  Session("EDIT_GRANTED_FORMGROUP" & dbkey)OR Session("EDIT_ANY_FORMGROUP" & dbkey) OR Session("DUPLICATE_GRANTED_FORMGROUP" & dbkey))  then
		thereturn = false
	else
		thereturn = true
	end if 
	dimManageFormgroups = thereturn
end function

function dimEditFormgroup(dbkey, formgroup)
	if Not dbkey <> "" then
		dbkey = request("dbname")
	end if
	if request("formgroup_id") <> "" then
		formgroup = formgroup_id
	end if
	if Not formgroup <> "" then
		formgroup = request("formgroup")
	end if

	if ((UCase(Application("FORMGROUP_OWNER" & dbkey & formgroup))=UCase(Session("UserName" & dbkey)))OR Session("EDIT_ANY_FORMGROUP" & dbkey) = true) and Not UCase(formgroup)="BASE_FORM_GROUP" then
		thereturn = false
	else
		thereturn = true
	end if 
	dimEditFormgroup = thereturn
end function

function dohideEditFormgroup(dbkey, formgroup)
	if request("formgroup_id") <> "" then
		formgroup = formgroup_id
	end if
	if (UCase(Session("FORMGROUP_OWNER" & dbkey & formgroup))=UCase(Session("UserName" & dbkey))) and Not UCase(formgroup)="BASE_FORM_GROUP" then
		thereturn = false
	else
		thereturn = true
	end if 
	dohideEditFormgroup = thereturn
end function

function dohideManageSchemas(dbkey, formgroup)
	if (Session("ADD_ADMIN_SCHEMA" & dbkey) or Session("EDIT_ADMIN_SCHEMA" & dbkey) or  Session("DELETE_ADMIN_SCHEMA" & dbkey)) then
		thereturn = false
	else
		thereturn = true
	end if 
	dohideManageSchemas = thereturn
end function

function dohideAdministrativeMenu(dbkey, formgroup)
	if Session("ADD_ADMIN_SCHEMA" & dbkey) or Session("EDIT_ADMIN_SCHEMA" & dbkey) or  Session("DELETE_ADMIN_SCHEMA" & dbkey) or Session("CSS_CREATE_USER" & dbkey) OR Session("CSS_EDIT_USER" & dbkey) OR Session("CSS_DELETE_USER" & dbkey) or  Session("CSS_CREATE_ROLE" & dbkey) OR Session("CSS_EDIT_ROLE" & dbkey) OR Session("CSS_DELETE_ROLE" & dbkey) then
		thereturn = false
	else
		thereturn = true
	end if 
	dohideAdministrativeMenu = thereturn
end function

function dohideManageFormgroups(dbkey, formgroup)
	if (Session("ADD_USER_FORMGROUP" & dbkey) or Session("EDIT_USER_FORMGROUP" & dbkey) or  Session("DELETE_USER_FORMGROUP" & dbkey)or  Session("EDIT_GRANTED_FORMGROUP" & dbkey)OR Session("EDIT_ANY_FORMGROUP" & dbkey) OR Session("DUPLICATE_GRANTED_FORMGROUP" & dbkey))  then
		thereturn= false
	else
		thereturn= true
	end if
	dohideManageFormgroups = thereturn
end function

function dohideManageUsers(dbkey, formgroup)

	if Session("CSS_CREATE_USER" & dbkey) OR Session("CSS_EDIT_USER" & dbkey) OR Session("CSS_DELETE_USER" & dbkey) then
		thereturn = false
	else
		thereturn = true
	end if 
	dohideManageUsers = thereturn
end function

function dohideManageRoles(dbkey, formgroup)

	if Session("CSS_CREATE_ROLE" & dbkey) OR Session("CSS_EDIT_ROLE" & dbkey) OR Session("CSS_DELETE_ROLE" & dbkey)  then
		thereturn = false
	else
		thereturn = true
	end if 
	dohideManageRoles = thereturn
end function

function dimSetDefaultFormgroup(dbkey, formgroup)
	if (Session("ADD_ADMIN_SCHEMA" & dbkey) or Session("EDIT_ADMIN_SCHEMA" & dbkey) or  Session("DELETE_ADMIN_SCHEMA" & dbkey)) then
		thereturn = false
	else
		thereturn = true
	end if 
	dimSetDefaultFormgroup = thereturn
end function

function doHideReportMenu(dbkey, formgroup)
	formmode = request("formmode")
	if Not formgroup = "base_from_group" then
		if (UCase(formmode) = "LIST" or UCase(formmode)="EDIT")AND (CBool(Application("ENABLE_REPORT_GENERATION")) = true) then
			
			thereturn = false
		else
			thereturn = true
		end if
	else
		thereturn = true
	end if
	doHideReportMenu = theReturn
end function



'*****************************Dim and Hide functions for standard Cows menus and items**************************


function dimRestoreHitListHistoryItemBS(dbkey, formgroup)

	dim HistoryExists
	dim thereturn
	
	HistoryExists = Session("HitListHistoryExists" & dbkey &  formgroup)

	if HistoryExists  <> "" then
		thereturn =  false
	else
		thereturn = true
	end if
	
	dimRestoreHitListHistoryItemBS = thereturn
End Function 

function dimRestoreHitListItemBS(dbkey, formgroup)
	dim HistLists 
	dim thereturn
	HistLists =Session("HitListExists" & dbkey &  formgroup)
	if HistLists = "" then
		thereturn =  true
	else
		thereturn = false
	end if
	
	dimRestoreHitListItemBS = thereturn
End Function 


function dimRestoreLastHitlistItemBS(dbkey, formgroup)
	dim HistLists 
	dim thereturn
	HistLists =Session("HitListHistoryExists" & dbkey &  formgroup)
	if HistLists = ""  then
		thereturn = true
	else
		thereturn = false
	end if
	dimRestoreLastHitlistItemBS = thereturn
End Function 

function dimRestoreQueryItemBS(dbkey, formgroup)
	dim QueriesExists
	dim thereturn
	QueriesExists =Session("SavedQueriesExists" & dbkey &  formgroup)
	if QueriesExists  <> ""  then
		thereturn =  false
	else
		thereturn = true
	end if
	
	dimRestoreQueryItemBS = thereturn
End Function 

function dimRestoreLastQueryItemBS(dbkey, formgroup)
	dim HistoryExists
	dim thereturn
	HistoryExists =Session("QueryHistoryExists" & dbkey &  formgroup)
	if HistoryExists  <> "" then
		thereturn =  false
	else
		thereturn = true
	end if
	dimRestoreLastQueryItemBS = thereturn
End Function 

function dimRestoreQueryHistoryItemBS(dbkey, formgroup)
	dim HistoryExists
	dim thereturn
	HistoryExists =Session("QueryHistoryExists" & dbkey &  formgroup)
	if HistoryExists  <> "" then
		thereturn =  false
	else
		thereturn = true
	end if
	
	dimRestoreQueryHistoryItemBS = thereturn
End Function 


function hideQueriesMenuBS(dbkey, formgroup)
	dim thereturn
	if CBool(Application("ALLOW_QUERY_MANAGEMENT")) = true then
		thereturn = false
	else
		thereturn = true
	end if
	hideQueriesMenuBS = thereturn
End function 

function hideHitListsMenuBS(dbkey, formgroup)
	dim thereturn
	if CBool(Application("ALLOW_HITLIST_MANAGEMENT")) = true then
		thereturn = false
	else
		thereturn = true
	end if

	hideHitListsMenuBS = thereturn
End function 

function hideHistoryMenuBS(dbkey, formgroup)
	dim thereturn
	if (CBool(Application("ALLOW_QUERY_MANAGEMENT")) = false) AND (CBool(Application("ALLOW_HITLIST_MANAGMENT")) = false) then
		thereturn = true
	else
		thereturn = false
	end if

	hideHistoryMenuBS = thereturn
End function 

function hideRestoreHitlistHistoryMenuBS(dbkey, formgroup)
	dim thereturn
	if Application("Expire_hitlist_history_days") = 0 then
		thereturn = true
	else
		thereturn = false
	end if

	hideRestoreHitlistHistoryMenuBS = thereturn
End function 



function dimSaveQueryBS(dbkey, formgroup)
	if  UCase(request("formmode")) = "EDIT" or UCase(request("formmode")) = "LIST" then
		thereturn = false
	else
		thereturn = true
	end if 
	dimSaveQueryBS = thereturn
end function

function dimSaveHitlistBS(dbkey, formgroup)
	if  UCase(request("formmode")) = "EDIT" or UCase(request("formmode")) = "LIST" then
		thereturn = false
	else
		thereturn = true
	end if 
	dimSaveHitlistBS = thereturn
end function

 %>
