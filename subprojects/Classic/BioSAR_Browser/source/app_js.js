
<script language = "javascript">
//Copyright 1999-2003 CambridgeSoft Corporation. All rights reserved%>
//PURPOSE OF FILE: TO add custom javascript functions to an applciation
//All form files generated by the wizard have a #INCLUDE for this file. Add the #INCLUDE to form files
//that you might add to the application.
function EchoNode(id){
	alert ('Node ' + id + ' Selected by user!');
}



function EchoItemAdded(nodeID, treeItemID){
	alert ('New item ' + treeItemID + ' added to the tree at node ' + nodeID + '!');
}

function OpenDialog3(url, name, type){	
	WindowDef_1 = "height=530, width= 530px, top=50, left=0";
	WindowDef_2 = "height=580, width= 850px, top=0, left=0";
	WindowDef_3 = "height=450, width= 360px, top=50, left=540";
	WindowDef_4 = "height=450, width= 550px, top=50, left=200";
	WindowDef_5 = "height=600, width= 800px, top=0, left=100";		
	var WindowDef = eval("WindowDef_" + type);
	var attribs = "toolbar=0,location=0,directories=0,status=0,menubar=0,scrollbars,resizable," + WindowDef;
	var DialogWindow = window.open(url,name,attribs);
	return DialogWindow;
	

return DialogWindow;
}

function getOpenFileButton2(fieldname){
	var outputval =""
	outputval ='<form>'
	outputval = outputval + '<input type="image" src="/<%=Application("AppKey")%>/graphics/open_file_btn.gif" onClick="this.form.fileName.click(); return false;">'
	outputval = outputval + '<input type="file" name="fileName" onChange = "upload_file" style="visibility: hidden;">'
	outputval = outputval + '</form>'
	document.write(outputval)

}



function getOpenFileButton(fieldname){


	var outpuval = ""
	outputval = '<a href="javascript:MainWindow.doOpenFileLoadWindow(&quot;' + fieldname + '&quot;)">'
	outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/open_file_btn.gif" BORDER="0"></a>'
	document.write(outputval)
}


function doOpenFileLoadWindow(fieldname){

		var w = ""
		if (w.name == null){		
			var w = window.open("/<%=application("appkey")%>/Load_IDS.asp?dbname=<%=dbkey%>&formgroup=<%=formgroup%>&fieldname=" + fieldname,"load_ids_from_file","width=450,height=30,scrollbars=yes,status=yes,resizable=yes");
			w.focus()}
		else{
			w.focus()}
	}

function doRestoreFormgroup(){

	MainWindow = top.main
	restore_url = "/biosar_browser/biosar_browser/mainpage.asp?bypass_ini=true&dbname=biosar_browser&refreshPath=/biosar_browser/biosar_browser/mainpage.asp&formgroup=base_form_group"
	restore_url = restore_url +	"&formmode=search&TreeID=1&TreeTypeID=" + "<%=Session("PRIVATE_CATEGORY_TREE_TYPE_ID")%>" + ",2"
	restore_url = restore_url + "&ItemURL=/biosar_browser/biosar_browser/biosar_browser_action.asp%3Fdataaction=db%26bypass_ini=true"
	restore_url = restore_url + "&ItemQSId=formgroup&ItemTarget=main&ItemTypeID=2&TreeMode=open_item"
	restore_url = restore_url + "&ClearNodes=0&QsRelay=formgroup,bypass_ini,formmode,refreshPath,showItems,qshelp,ItemQSId" + "&QSHelp=Click a link to select a query form"
	MainWindow.location.replace(restore_url)


}

function doShowSpreadsheet(current_index, page_size,sort_fields){

	OpenDialog3('/<%=application("appkey")%>/show_spreadsheet.asp?sort_fields=' + sort_fields + '&page_size=' + page_size + '&formmode=<%=formmode%>&dbname=<%=dbkey%>&formgroup=<%=formgroup%>&current_index=' + current_index ,'MSpreadSheet',5)
			
}

function doShowBioViz(current_index, page_size,sort_fields){

	OpenDialog3('/<%=application("appkey")%>/show_bioviz.asp?sort_fields=' + sort_fields + '&page_size=' + page_size + '&dbname=<%=dbkey%>&formgroup=<%=formgroup%>&current_index=' + current_index ,'MBioVizSheet',5)
			
}
function doShowWordDoc(current_index, page_size,sort_fields){
	OpenDialog3('/<%=application("appkey")%>/show_worddoc.asp?sort_fields=' + sort_fields + '&page_size=' + page_size + '&dbname=<%=dbkey%>&formgroup=<%=formgroup%>&current_index=' + current_index ,'MSpreadSheet',6)
			
}

function doManageFormGroups(){
	MainWindow = top.main
	MainWindow.location.replace('/biosar_browser/biosar_browser_admin/admin_tool/user_forms.asp?formgroup=base_form_group&dbname=biosar_browser')

	
}

function doEditFormGroup(){
	
		MainWindow = top.main
		MainWindow.location.replace('/biosar_browser/biosar_browser_admin/admin_tool/user_tables.asp?formgroup=base_form_group&formgroup_id=<%=request("formgroup")%>&dbname=biosar_browser&return_to_form=true')
	
	
}

function doManageSchemas(){
	MainWindow = top.main
	MainWindow.location.replace('/biosar_browser/biosar_browser_admin/admin_tool/admin_table_list.asp?action=get_schema_list&formgroup=base_form_group&dbname=biosar_browser')
	
}

function doManageUsers(){

	OpenDialog2('/biosar_browser/cs_security/manageUsers.asp?dbkey=biosar_browser&PrivTableName=BIOSAR_BROWSER_PRIVILEGES', 'Musers', 2)
	
}

function doManageRoles(){
	OpenDialog2('/biosar_browser/cs_security/manageRoles.asp?dbkey=biosar_browser&PrivTableName=BIOSAR_BROWSER_PRIVILEGES', 'Mroles', 2)
	
}



function returnToForm(new_location){
		MainWindow.location.replace(new_location)
}

function toggleColumnLayout(){
	var currentLayout
	var currentURL
	var newURL
	currentLayout = MainWindow.document.cows_input_form.COLUMN_LAYOUT.value
	currentURL = MainWindow.location.href
	if (currentLayout.toLowerCase()=="fields_across"){
		if (currentURL.indexOf("column_layout") != -1) {
			var newURL = MainWindow.location.href.replace("&column_layout=fields_across" ,"&column_layout=fields_down" )
		}
		else{
			var newURL = MainWindow.location.href.replace("&dbname=","&column_layout=fields_down&dbname=")
		}

	}
	if (currentLayout.toLowerCase()=="fields_down"){
		if (currentURL.indexOf("column_layout") != -1) {
			var newURL = MainWindow.location.href.replace("&column_layout=fields_down" ,"&column_layout=fields_across" )
		}
		else{
			var newURL = MainWindow.location.href.replace("&dbname=","&column_layout=fields_across&dbname=")
		}
	}
	
	if (newURL.indexOf("preserve_qs") == -1) {
		newURL = newURL.replace("&dbname=","&preserve_qs=true&dbname=")
	}
	MainWindow.location.href = newURL;
	

}

function toggleDataDisplay(){
	var currentDisplay
	var currentURL
	var newURL
	currentDisplay = MainWindow.document.cows_input_form.CHILD_DATA_DISPLAY.value
	currentURL = MainWindow.location.href
		
	if (currentDisplay.toUpperCase()=="SHOW_ALL"){
		if (currentURL.indexOf("child_data_display") != -1) {
			 newURL = MainWindow.location.href.replace("&child_data_display=SHOW_ALL" ,"&child_data_display=LIMIT" )
		}
		else{
			 newURL = MainWindow.location.href.replace("&dbname=","&child_data_display=LIMIT&dbname=")
		}

	}
	if (currentDisplay.toUpperCase()=="LIMIT"){
		if (currentURL.indexOf("child_data_display") != -1) {
			newURL = MainWindow.location.href.replace("&child_data_display=LIMIT" ,"&child_data_display=SHOW_ALL" )
		}
		else{
			 newURL = MainWindow.location.href.replace("&dbname=","&child_data_display=SHOW_ALL&dbname=")
		}

	}
	if (newURL.indexOf("preserve_qs") == -1) {
		newURL = newURL.replace("&dbname=","&preserve_qs=true&dbname=")
	}
	MainWindow.location.href = newURL;


}


function slideHorizontal() {
	if (document.cows_input_form.disableSlider){
		if (document.cows_input_form.disableColSlider[1].checked) return;
		with(document.body){ 
				var headers = document.getElementsByName(base_table);
				var firstColumn = document.getElementsByName("firstColumnmain");
					if (headers.length>0){
							for (var i=0;i<firstColumn.length;i++){				
								firstColumn[i].style.left = scrollLeft;
							}
					}			
		}
	}
} 

function slideVertical() {
	if (document.cows_input_form.disableSlider){
		if (document.cows_input_form.disableSlider[1].checked) return;
		
		with(document.body){ 
				var headers = document.getElementsByName(base_table);
				var columnNames = document.getElementsByName("columnName");
				for (var i=0;i<columnNames.length;i++){
					if (headers.length>0){
						headers[0].style.top = 0; 
						var setvalue= 10
						columnNames[i].style.top = scrollTop;
					}
				}
				//DGB move the table headers as well
				var tableHeaders = document.getElementsByName("tableHeader");
				for (var i=0;i<tableHeaders.length;i++){
					if (tableHeaders.length>0){
						tableHeaders[i].style.top = scrollTop;
					}
				}
		}
	}
} 

function setSliderDefault(elm){
	var Cookiename = elm[0].name;
	var index = getCookieVal(Cookiename);
	if (index == null){
		index = 0;
		elm[index].checked = true;
		saveSliderDefault(elm)
	}
	else{ 
		elm[index].checked = true;
	}	
}

function saveSliderDefault(elm){
	var Cookiename = elm[0].name;
	var value; 
	(elm[1].checked) ? value = "1" : value = "0"; 
	var nextyear = new Date()
	nextyear.setFullYear(nextyear.getFullYear() +1);
	document.cookie = Cookiename  + "="  + escape(value) + "; expires=" + nextyear.toGMTString() + "; path=/" + appkey;
}


//function added by JHS 4/16/2007 for jumping forms

function doJumpForm()
{
	box = document.forms[0].jumpselect;
	destination = box.options[box.selectedIndex].value;
	if (destination) {
		if (parent.name == "main")
		{
			parent.location.href = destination;
		}
		else
		{
			location.href = destination;
		}
	}
	
}

function printBioSARPage(){
	var IE4browser= "<%=detectIE4%>"
	var NSbrowser = "<%=detectNS%>"
	if (window.print || (NSbrowser.toLowercase == "true")) {
	    if (parent.frames.main != null)
	    {
		    parent.frames["main"].focus();
		    window.print();
		}
		else
		{
		    parent.frames["mainFrame"].focus();
		    window.print();
		}
	}
	else {
		if (window.print || IE4browser.toLowercase != "true"){
		    if (parent.frames.main != null)
		    {
			    parent.frames["main"].focus();
			    window.print();
			}
		}
		else{
			alert('The print button does not work with IE 4, please use Ctrl-P instead');
		}
	}
}

</script>

