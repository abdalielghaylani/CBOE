<%@ LANGUAGE=VBScript %>
<%Response.Expires=0%>
<%'Copyright 1999-2003 CambridgeSoft Corporation. All rights reserved
'DO NOT EDIT THIS FILE%>
<%dbkey = ""
formgroup = ""
formmode = Request("formmode")
if not formmode <> "" then
	formmode = "search"
end if
dbkey = Request("dbname")
if not dbkey <> "" then 
	dbkey = "reg"
end if
appkey = Application("appkey")
dataaction = Request("dataaction")

formgroup = Request("formgroup")
if not formgroup <> "" then 
	formgroup = "base_form_group"
end if
if Application("DBLoaded" & dbkey) = True then
	userinfopath = "/" & appkey & "/user_info.asp?dbname=" & dbkey & "&formgroup=" & formgroup
	
	Select Case UCase(dataaction)
		Case "MAINPAGE"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path = "/" & Application("AppKey") & "/" & dbkey & "/mainpage.asp?formgroup=base_form_group&dbname=" & dbkey & "&timer=" & Timer
			userinfopath="javascript:''" 
		Case "LOGIN"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path = "/" & Application("AppKey") & "/login.asp?formgroup=base_form_group&dbname=" & dbkey & "&timer=" & Timer
			userinfopath="javascript:''" 
		Case "FULL_COMMIT"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path = "/" & Application("AppKey") & "/" & dbkey & "/reg_ctrbt_form.asp?record_added=false&formmode=add_compounds&formgroup=reg_ctrbt_form_group&dbname=" & dbkey & "&commit_type=full_commit&timer=" & Timer
			userinfopath = "/" & appkey & "/user_info.asp?dbname=" & dbkey & "&formgroup=reg_ctrbt_form_group&formmode=add_compounds&timer=" & Timer
		Case "ADD_REAGENT"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path = "/" & Application("AppKey") & "/" & dbkey & "/reagent_ctrbt_form.asp?record_added=false&formmode=add_compounds&formgroup=add_reagent_ctrbt_form_group&dbname=" & dbkey & "&commit_type=full_commit&timer=" & Timer

		Case "BATCH_COMMIT"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path = "/" & Application("AppKey") & "/source/get_registered.asp?nav_override=true&formmode=get_registered&record_added=false&formgroup=batch_ctrbt_form_group&dbname=" & dbkey & "&commit_type=batch_commit&the_regnum_verified=false&timer=" & Timer
			userinfopath = "/" & appkey & "/user_info.asp?dbname=" & dbkey & "&formgroup=batch_ctrbt_form_group&formmode=get_registered&timer=" & Timer

		Case "ADD_IDENTIFIERS"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path = "/" & Application("AppKey") & "/source/get_registered.asp?nav_override=true&formmode=get_registered&record_added=false&formgroup=identifier_ctrbt_form_group&dbname=" & dbkey & "&commit_type=add_identifiers&the_regnum_verified=false&timer=" & Timer
			userinfopath = "/" & appkey & "/user_info.asp?dbname=" & dbkey & "&formgroup=identifier_ctrbt_form_group&formmode=get_registered&timer=" & Timer

		Case "ADD_SALT"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path = "/" & Application("AppKey") & "/source/get_registered.asp?nav_override=true&formmode=get_registered&record_added=false&formgroup=salt_ctrbt_form_group&dbname=" & dbkey & "&commit_type=add_salt&the_regnum_verified=false&timer=" & Timer
			userinfopath = "/" & appkey & "/user_info.asp?dbname=" & dbkey & "&formgroup=salt_ctrbt_form_group&formmode=get_registered&timer=" & Timer

		Case "ANALYTICS_DATA"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path = "/" & Application("AppKey") & "/analytics/Analytics_ssheet.asp?nav_override=true&formmode=analytics_data&record_added=false&formgroup=analytics_form_group&dbname=" & dbkey & "&timer=" & Timer
			userinfopath = "/" & appkey & "/user_info.asp?dbname=" & dbkey & "&formgroup=analytics_form_group&formmode=analytics_data&timer=" & Timer
		'Start Givaudan EVAL customization
		Case "ADD_EVAL_DATA"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path = "/" & Application("AppKey") & "/source/get_registered.asp?nav_override=true&formmode=get_registered&record_added=false&formgroup=add_eval_data_form_group&dbname=" & dbkey & "&commit_type=add_eval_data&the_regnum_verified=false&timer=" & Timer
			session("cancel_return_location" & dbkey & formgroup)= path
		'End Givaudan EVAL customization
		
		Case "SARTABLE"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path = "/" & Application("AppKey") & "/sartable/SARTable_main.asp?nav_override=true&formmode=sartable&record_added=false&formgroup=sartable_form_group&dbname=" & dbkey & "&timer=" & Timer
		Case "ADD_ANALYTICS_DATA"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path = "/" & Application("AppKey") & "/source/get_registered.asp?nav_override=true&formmode=get_registered&record_added=false&formgroup=add_analytics_form_group&dbname=" & dbkey & "&commit_type=add_analytics_data&the_regnum_verified=false&timer=" & Timer
			
		Case "MANAGE_SECURITY"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path = "/" & Application("AppKey") & "/cs_security/manage_security/manage_security_input_form.asp?nav_override=true&formgroup=manage_users_form_group&formmode=manage_users&dbname=" & dbkey & "&timer=" & Timer
		Case "CHANGE_PASSWORD"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path = "/" & Application("AppKey") & "/cs_security/manage_security/manage_pwd_result_form.asp?nav_override=true&formgroup=manage_users_form_group&formmode=manage_passwords&dbname=" & dbkey & "&timer=" & Timer
			userinfopath = "/" & appkey & "/user_info.asp?dbname=" & dbkey & "&formgroup=manage_users_form_group&formmode=manage_passwords&timer=" & Timer

		Case "MANAGE_TABLES"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path = "/" & Application("AppKey") & "/cs_security/manage_tables/manage_tables_input_form.asp?nav_override=true&formgroup=manage_tables_form_group&formmode=manage_tables&dbname=" & dbkey & "&timer=" & Timer
			userinfopath = "/" & appkey & "/user_info.asp?dbname=" & dbkey & "&formgroup=manage_tables_form_group&formmode=manage_tables&timer=" & Timer

		Case "MANAGE_REG_TABLES"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path = "/" & Application("AppKey") & "/admin/manage_reg_tables/manage_reg_tables_input_form.asp?nav_override=true&formgroup=manage_reg_tables_form_group&formmode=manage_reg_tables&dbname=" & dbkey & "&timer=" & Timer
			userinfopath = "/" & appkey & "/user_info.asp?dbname=" & dbkey & "&formgroup=manage_reg_tables_form_group&formmode=manage_reg_tables&timer=" & Timer

		Case "MANAGE_ANALYTICS_TABLES"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path = "/" & Application("AppKey") & "/admin/manage_analytics_tables/manage_analytic_tables_input_form.asp?nav_override=true&formgroup=manage_analytics_tables_form_group&formmode=manage_analytics_tables&dbname=" & dbkey & "&timer=" & Timer
			userinfopath = "/" & appkey & "/user_info.asp?dbname=" & dbkey & "&formgroup=manage_analytics_tables_form_group&formmode=manage_analytics_tables&timer=" & Timer

		
		Case "GET_SQL_STRING"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path= "/" & Application("AppKey") & "/" & dbkey & "/" & dbkey &"_action.asp?" & request.querystring & "&timer=" & Timer
			userinfopath="javascript:''"         
			'store sql
			
			Session("sql_string")=Request("sql_string")
			Session("table_name") = Request("table_name")
		Case "REMOTE_REQUEST"
			userinfopath="javascript:''" 
			Session("CurrentLocation" & dbkey & formgroup) = Session("clean_transfer")
		Case "QUERY_STRING"
			Session("CurrentLocation" & dbkey & formgroup) = ""
			path= "/" & appkey  & "/" &  dbkey & "/" & dbkey & "_action.asp?" & request.querystring & "&timer=" & Timer
			userinfopath="javascript:''" 
		Case Else
			if not Session("CurrentLocation" & dbkey & formgroup)<> "" then
				'Session("CurrentLocation" & dbkey & formgroup) = ""
				thearray = Application(formgroup & dbkey)
				CONST kInputFormMode = 3
				formmode =thearray(kInputFormMode)
				path = "/" & appkey  & "/" &  dbkey & "/" & dbkey & "_action.asp" & "?formgroup=" & formgroup & "&dataaction=db&formmode=" & formmode & "&dbname=" & dbkey
				end if
		End Select
	if Not Session("CurrentLocation" & dbkey & formgroup) <> "" then
		Session("CurrentLocation" & dbkey & formgroup)=path
	end if
	helperpath = "/" & appkey  & "/" &  "helper.asp?formgroup=" & formgroup & "&dataaction=db&formmode=" & formmode & "&dbname=" & dbkey 
%>
<html>
<head>
<title>Registration Enterprise</title>
</head>

<frameset BORDER="0" FRAMEBORDER="0" FRAMESPACING="0" rows="168,*">
	<frame BORDER="0" SCROLLING="NO" SRC="javascript:''" NAME="navbar">
		<frameset BORDER="0" FRAMEBORDER="0" FRAMESPACING="0" cols="20,*">
			<frameset BORDER="0" FRAMEBORDER="0" FRAMESPACING="0" rows="500,*">
				<frame BORDER="0" MARGINWIDTH="0" MARGINHEIGHT="0" SRC="<%=userinfopath%>" NAME="userinfo" scrolling="auto">
				<frame BORDER="0" MARGINWIDTH="0" MARGINHEIGHT="0" SRC="<%=helperpath%>" NAME="helper" scrolling="no">
			</frameset>
			<frame BORDER="0" MARGINWIDTH="0" MARGINHEIGHT="0" SRC="<%=Session("CurrentLocation" & dbkey & formgroup)%>" NAME="main">
		</frameset>
	<noframes>
	<body>
	</body>
	</noframes>
</frameset>
</html>
<%else 'db not loaded
	Response.Write "The web database requested did not initialize.<br>"
	Response.Write "For details, see the log file at <a href=" & Application("AppPathHTTP") & "/logfiles/" & dbkey & "log.html" & ">" & Application("AppPathHTTP") & "/logfiles/" & dbkey & "log.html</a>"
end if
%>
