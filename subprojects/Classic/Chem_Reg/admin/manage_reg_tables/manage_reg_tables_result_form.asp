<%@ LANGUAGE=VBScript %>
<%	Response.expires=0
'Copyright 1999-2003 CambridgeSoft Corporation. All rights reserved
'DO NOT EDIT THIS FILE

dbkey="reg"
if Not Session("UserValidated" & dbkey) = 1 then  response.redirect "/" & Application("Appkey") & "/logged_out.asp"


%>



<html>

<head>

<!--#INCLUDE VIRTUAL = "/cfserverasp/source/cows_func_js.asp"-->
<!--#INCLUDE FILE = "../../source/secure_nav.asp"-->
<!--#INCLUDE FILE = "../../source/app_js.js"-->
<!--#INCLUDE FILE = "../../reg/universal_ss.asp"-->

<script language="javascript">

var unique_id = ""
var limit_access = ""

</script>
<%
formmode = UCase(request("formmode"))
%>



<title>Manage Registry Tables</title>
</head>

<body >
<!--#INCLUDE FILE = "../../source/app_vbs.asp"-->
<!--#INCLUDE FILE = "../../source/app_js.js"-->
<!--#INCLUDE VIRTUAL = "/cfserverasp/source/header_vbs.asp"-->
<%
Session("fEmptyRecordset" & dbkey & formgroup) = False
Session("error" & dbkey & formgroup)= false
'if there are no items in the table, you need to trick the system to think there is a recordset
	if formmode = "ADD_RECORD" and Not isArray(Session("Base_RS" & dbkey & formgroup))then
		redim basearray(1,1)
		basearray(0,r) = 1
		Session("Base_RS" & dbkey & formgroup) = basearray
	end if
	
Session("override_current_index" & dbkey & formgroup)=True
%>
<!--#INCLUDE VIRTUAL ="/cfserverasp/source/recordset_vbs.asp"-->
<%'BaseID represents the primary key for the recordset from the base array for the current row
'BaseActualIndex is the actual id for the index the record is at in the array
'BaseRunningIndex if the id based on the number shown in list view
'BastTotalRecords is the recordcount for the array
'BaseRS (below is the recordset that is pulled for each record generated
on error resume next
limit_access = request("limit_access")
	if formmode = "ADD_RECORD" then
		bAdd = true
		bUpdate = false
		bEditWG = true
		bEditUserID = true
	else
		bAdd = false
		bUpdate = true
		if request("limit_access")= "workgroup" then
	
			if Session("Edit_WorkGroup" & dbkey) = true then
				
					bEditWG=true
				else
					bEditWG=false
				end if
			
		else
			bEditWG=false
			if Session("Edit_Users_Table" & dbkey) =  True then
				bEditUserID=true
			else
				bEditUserID=false
			end if
		end if
	end if
	
	uniqueid = BaseID
	commit_type = "full_commit_ns"
	table_name = request("table_name")
	
	if Not table_name <> "" then
		Response.Write "no_table_name"
		Response.End
	end if
	Set DataConn = GetConnection(dbkey, formgroup, table_name)
	if DataConn.State=0 then ' assume user has been logged out
		DoLoggedOutMsg()
	end if
	if bUpdate = true then
		baseid_name = GetTableVal(dbkey, table_name, kPrimaryKey)
		datatype =getDataType(dbkey,  formgroup,  table_name & "." & baseid_name)
		delimiter = GetFieldDelimiter(datatype)
		sql = "Select * from " & table_name & " where " & baseid_name & "=" & delimiter&  BaseID & delimiter	
		Set BaseRS = DataConn.Execute(sql)
	end if
	yes_no_list = ":,0:No,1:Yes"

	
%>
<script language="javascript">

unique_id = "<%=baseID%>"
</script>
<%if bUpdate = true then
	ActiveFlag_TEXT= CBool(BaseRS("Active"))
	ActiveFlag_VAL = BaseRS("Active")
else
	ActiveFlag_TEXT= True
	ActiveFlag_VAL = "1"
end if

ActiveFlag_LIST="1:True,0:False"

'SYAN added on 5/27/2005 to fix CSBR-50860
if bUpdate = true then
	DupCheckScope_TEXT= CBool(BaseRS("DUP_CHECK_LOCAL"))
	DupCheckScope_VAL = BaseRS("DUP_CHECK_LOCAL")
else
	DupCheckScope_TEXT= False
	DupCheckScope_VAL = "0"
end if

DupCheckScope_LIST="1:True,0:False"

'End of SYAN modification

Select Case UCase(table_Name)
Case "NOTEBOOKS"
if bUpdate = true then
	Lookup_People_Person_ID_TEXT = getValueFromTablewConn(DataConn,"People", "person_id", BaseRS("User_code"), "Last_Name")			
	Lookup_People_Person_ID_VAL =  BaseRS("User_code")
end if

Lookup_People_Person_ID_LIST= GetPeopleList(DataConn)

Case "PEOPLE"
if bUpdate = true then
	
	Lookup_People_Person_ID_TEXT = getValueFromTablewConn(DataConn,"People", "person_ID", BaseRS("User_code"), "Last_Name")			
	Lookup_People_Person_ID_VAL =  BaseRS("Supervisor_Internal_ID")
	Lookup_Site_Site_ID_TEXT = getValueFromTablewConn(DataConn,"Sites", "Site_ID", BaseRS("Site_ID"), "Site_Name")	
	Lookup_Site_Site_ID_VAL =  BaseRS("Site_ID")
	Lookup_People_UserID_TEXT = BaseRS("User_ID")
	Lookup_People_UserID_VAL = BaseRS("User_ID")
	currentPeople_ID = UCase(Lookup_People_UserID_VAL) & ":" & UCase(Lookup_People_UserID_TEXT)
	
end if
	Lookup_People_Person_ID_LIST= GetPeopleList(DataConn)
	Lookup_Site_Site_ID_LIST= GetSiteList(DataConn)

	if bUpdate = true THEN
	
		if bEditUserID = true then
			theList = ListAllUnBoundUsers(dbkey, formgroup,Application("appkey") & "_Privileges")
						
			if Not theList <> "" then
				Lookup_People_UserID_LIST=currentPeople_ID & "," & "Login Disabled:Login Disabled"
			else
				Lookup_People_UserID_LIST=theList & "," & currentPeople_ID & "," & "Login Disabled:Login Disabled"
			end if
		else
			Lookup_People_UserID_LIST= ""
		end if

	else
		theList = ListAllUnBoundUsers(dbkey, formgroup,Application("appkey") & "_Privileges")
		if theList <> "" then
			Lookup_People_UserID_LIST=theList & "," & "Login Disabled:Login Disabled"
		else
			Lookup_People_UserID_LIST= "Login Disabled:Login Disabled"
		end if
	end if
End Select
Select Case UCase(table_Name)
Case "NOTEBOOKS"%>	
<table border = 0>
<script language="javascript">
	required_fields="Notebooks.Notebook_Name;0:Notebook Name"
</script>
<%if bUpdate = true then%>
<tr><td <%=td_caption_bgcolor%>>Notebook_Number</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Notebooks.Notebook_Number", "raw_no_edit", "0", "30"%></td></tr>
<%end if%>
<tr><td <%=td_caption_bgcolor%>>Notebook_Name</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Notebooks.Notebook_Name", "raw", "isValid(this,22)", "30:250"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Location</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Notebooks.Location", "raw", "0", "30:250"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Microfiche</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Notebooks.Microfiche", "raw", "0", "30:250"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>User Last Name</td><td <%=td_bgcolor%>><%ShowLookUpList dbkey, formgroup,BaseRS,"Notebooks.User_Code", Lookup_People_Person_ID_LIST,  Lookup_People_Person_ID_VAL,Lookup_People_Person_ID_TEXT,0,false,"value","1"%>
<tr><td <%=td_caption_bgcolor%>>Active</td><td <%=td_bgcolor%>><%ShowLookUpList dbkey, formgroup,BaseRS,"Notebooks.Active",ActiveFlag_LIST,  ActiveFlag_VAL,ActiveFlag_TEXT,0,false,"value","1"%></td></tr>

</table>
<%Case "PROJECTS"%>
<table border = 0>
<script language="javascript">
	required_fields="Projects.Project_Name;0:Project Name"
</script>
<%if bUpdate = true then%>
<tr><td <%=td_caption_bgcolor%>>ID</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Projects.Project_Internal_ID", "raw_no_edit", "0", "30"%></td></tr>
<%end if
if CBOOL(Application("PROJECTS_NAMED_OWNER")) = True  then%>
<tr><td <%=td_caption_bgcolor%>>Owner Name</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Projects.Project_Name", "raw", "isValid(this,22)", "30"%></td></tr>
<%else%>
<tr><td <%=td_caption_bgcolor%>>Project Name</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Projects.Project_Name", "raw", "isValid(this,22)", "30"%></td></tr>

<%end if%>
<tr><td <%=td_caption_bgcolor%>>Active</td><td <%=td_bgcolor%>><%ShowLookUpList dbkey, formgroup,BaseRS,"Projects.Active",ActiveFlag_LIST,  ActiveFlag_VAL,ActiveFlag_TEXT,0,false,"value","1"%></td></tr>

</table>
	
<%Case "BATCH_PROJECTS"%>
<table border = 0>
<script language="javascript">
	required_fields="BATCH_PROJECTS.PROJECT_NAME;0:Batch Project Name"
</script>
<%if bUpdate = true then%>
<tr><td <%=td_caption_bgcolor%>>ID</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"BATCH_PROJECTS.BATCH_PROJECT_ID", "raw_no_edit", "0", "30"%></td></tr>
<%end if%>
<tr><td <%=td_caption_bgcolor%>>Project Name</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"BATCH_PROJECTS.PROJECT_NAME", "raw", "isValid(this,22)", "30:250"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Active</td><td <%=td_bgcolor%>><%ShowLookUpList dbkey, formgroup,BaseRS,"BATCH_PROJECTS.ACTIVE",ActiveFlag_LIST,  ActiveFlag_VAL,ActiveFlag_TEXT,0,false,"value","1"%></td></tr>
	
</table>

<table>
<tr><br><br><td <%=td_caption_bgcolor%>><font <%=font_header_default_2%>> <b>Default Owner</b></font></td></tr><tr>

<%	Projects_List = GetProjectsList(DataConn)
	if bUpdate = true then
		Projects_Val = BaseRS("Owner_ID")
		Projects_Text = getValueFromTablewConn(DataConn, "Projects", "Project_Internal_ID", Projects_Val, "Project_Name")
	else
		Projects_Val = ""
		Projects_Text = ""
	end if
%>
	<td <%=td_bgcolor%> align="left"><%ShowLookUpList dbkey, formgroup,BaseRS,"BATCH_PROJECTS.OWNER_ID", Projects_List, Projects_Val,Projects_Text,0,true,"value","0"%> </td>


</td></tr>

</table>
<table>
<tr><br><br><td <%=td_caption_bgcolor%>><font <%=font_header_default_2%>> <b>Default Utilizations</b></font></td></tr><tr>
<table>
<%Set UtilRS = server.createobject("ADODB.Recordset")
	UtilRS.Open "select * from utilizations", DataConn
	if Not (UtilRS.EOF and UtilRS.BOF)then
		UtilRS.MoveFirst
	else
		'BEGIN OF MODIFICATION BY Andrea Yang for BUG CSBR-65469
		'response.write "No Utilizations Found"
		response.write "No Utilizations Found "
		'END OF MODIFICATION BY Andrea Yang for BUG CSBR-65469			
	end if
	Set BatchProjUtilRS = server.createobject("ADODB.Recordset")
if bUpdate = true then
	
		if Not (UtilRS.BOF  and UtilRS.EOF)then
			'UtilRS.MoveFirst		
			Do While Not UtilRS.EOF	
				yes_no_not_setutilList = "-1:NOT SET,1:YES,0:NO"
				yes_no_utilList = "1:YES,0:NO"	
				UtilText = UtilRS("UTILIZATION_TEXT")		
				
				itemFound = false
				sql = "select * from batch_proj_utilizations where  batch_project_id="& BaseRS("batch_project_id") & " and utilization_id=" & UtilRS("utilization_id")
				BatchProjUtilRS.Open sql ,DataConn
					if Not (BatchProjUtilRS.BOF  and BatchProjUtilRS.EOF)then
						BatchProjUtilRS.MoveFirst
						yes_no_utilVal = BatchProjUtilRS("UTILIZATION_BOOLEAN")
						
							if CInt(yes_no_utilVal) = 1 then
									yes_no_utilText = "YES"
							else
									yes_no_utilText = "NO"
							end if%>
						<tr><td> <%=UtilText%></td>	<td>
						<%ShowLookUpList dbkey, formgroup,BatchProjUtilRS,"BATCH_PROJ_UTILIZATIONS.UTILIZATION_BOOLEAN" ,yes_no_utilList,  yes_no_utilVal,yes_no_utilTEXT,0,false,"value","1"%>
						</td></tr>
						<%BatchProjUtilRS.Close
						else 'no batch_projects found so output not set value%>
						<tr><td> <%=UtilText%></td>	<td>
							<%'This means it is a new permission that is not set
								ShowLookUpList dbkey, formgroup,UtilRS,"BATCH_PROJ_UTILIZATION_ID." & UtilRS("UTILIZATION_ID") ,yes_no_not_setutilList,  yes_no_not_setutilListVal,yes_no_not_setutilListTEXT,0,false,"value","1"%>
						</td></tr>
					<%end if 'if Not (BatchProjUtilRS.BOF  and BatchProjUtilRS.EOF)then
					
				UtilRS.MoveNext
			Loop		
		else
		response.write "no utilization permissions found"
		end if
	else 'if this is a new record
		Do While Not UtilRS.Eof
		utilText=UtilRS("UTILIZATION_TEXT")
		response.write "<tr><td>"
		if bUpdate = true then
			yes_no_utilList = "-1:NOT SET,1:YES,0:NO"
		else
			yes_no_utilList = "1:YES,0:NO"
		end if
			response.write "<td>" & utilText	& "<td>"  	
			ShowLookUpList dbkey, formgroup,UtilRS,"BATCH_PROJ_UTILIZATION_ID." & UtilRS("UTILIZATION_ID") ,yes_no_utilList,  yes_no_utilVal,yes_no_utilTEXT,0,false,"value","1"
		response.write "</td></tr>"
		UtilRS.MoveNext
	Loop
	end if%>
	</table>
</table>



<%Case "UTILIZATIONS"%>
<table border = 0>
<script language="javascript">
	required_fields="UTILIZATIONS.UTILIZATION_TEXT;0:Utilization"
</script>
<%if bUpdate = true then%>
<tr><td <%=td_caption_bgcolor%>>ID</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"UTILIZATIONS.UTILIZATION_ID", "raw_no_edit", "0", "30"%></td></tr>
<%end if%>
<tr><td <%=td_caption_bgcolor%>>Utilization</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"UTILIZATIONS.UTILIZATION_TEXT", "raw", "isValid(this,22)", "30:250"%></td></tr>

</table>

<%Case "SITES"%>
<table border = 0>
<script language="javascript">
	required_fields="Sites.Site_Name;0"
</script>
<%if bUpdate = true then%>
<tr><td <%=td_caption_bgcolor%>>ID</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Sites.Site_ID", "raw_no_edit", "isValid(this,22)", "30"%></td></tr>
<%end if%>
<tr><td <%=td_caption_bgcolor%>>Site Name</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Sites.Site_Name", "raw", "0", "30"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Site Code</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Sites.Site_Code", "raw", "0", "30"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Active</td><td <%=td_bgcolor%>><%ShowLookUpList dbkey, formgroup,BaseRS,"Sites.Active",ActiveFlag_LIST,  ActiveFlag_VAL,ActiveFlag_TEXT,0,false,"value","1"%></td></tr>
</table>

<%Case "SALTS"%>
<script language="javascript">
	required_fields="Salts.Salt_Name;0:Salt Name,Salts.Salt_MW;2:Salt MW"
</script>
<table border = 0>
<%if bUpdate = true then%>
<tr><td <%=td_caption_bgcolor%>>Salt Code</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Salts.Salt_Code", "raw_no_edit", "0", "30"%></td></tr>
<%end if%>
<tr><td <%=td_caption_bgcolor%>>Salt Name</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Salts.Salt_Name", "raw", "isValid(this,22)", "30:250"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Salt MW</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Salts.Salt_MW", "raw", "SCRIPT:isValid(this,5)", "30:10"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Salt MF</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Salts.Salt_MF", "raw", "0", "30:250"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Active</td><td <%=td_bgcolor%>><%ShowLookUpList dbkey, formgroup,BaseRS,"Salts.Active",ActiveFlag_LIST,  ActiveFlag_VAL,ActiveFlag_TEXT,0,false,"value","1"%></td></tr>
</table>

<%Case "SOLVATES"%>
<script language="javascript">
	required_fields="Solvates.Solvate_Name;0:Solvate Name,Solvates.Solvate_MW;2:Solvate MW"
</script>
<table border = 0>
<%if bUpdate = true then%>
<tr><td <%=td_caption_bgcolor%>>Solvate ID</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Solvates.Solvate_ID", "raw_no_edit", "0", "30"%></td></tr>
<%end if%>
<tr><td <%=td_caption_bgcolor%>>Solvate Name</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Solvates.Solvate_Name", "raw", "isValid(this,22)", "30:250"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Solvate MW</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Solvates.Solvate_MW", "raw", "SCRIPT:isValid(this,5)", "30:10"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Solvate MF</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Solvates.Solvate_MF", "raw", "0", "30:250"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Active</td><td <%=td_bgcolor%>><%ShowLookUpList dbkey, formgroup,BaseRS,"Solvates.Active",ActiveFlag_LIST,  ActiveFlag_VAL,ActiveFlag_TEXT,0,false,"value","1"%></td></tr>
</table>

<%Case "SEQUENCE"%>
<script language="javascript">
	required_fields="Sequence.Prefix;0:Prefix,Sequence.Next_in_sequence;1:Next In Sequence,Sequence.ROOT_NUMBER_LENGTH;1:Root Number Length"
</script>

<table border=0>

<%if bUpdate = true then%>
<tr><td <%=td_caption_bgcolor%>>ID</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Sequence.Sequence_ID", "raw_no_edit", "0", "10"%></td></tr>
<%end if%>

<input type = "hidden" name = "current_value_list" value="<%=GetSequenceList(DataConn)%>">

<%if bUpdate = true then%>
<input type = "hidden" name = "current_value" value="<%=BaseRS("PREFIX")%>">
<tr><td <%=td_caption_bgcolor%>>Prefix</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Sequence.Prefix", "raw", "SCRIPT:checkDupEntry_Update(this,this.form,'prefix');checkForComma(this)", "10:150"%></td></tr>
<%else%>
<tr><td <%=td_caption_bgcolor%>>Prefix</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Sequence.Prefix", "raw", "SCRIPT:checkDupEntry(this,this.form,'prefix');checkForComma(this)", "10:150"%></td></tr>
<%end if%>

<%if bUpdate = true then%>
<tr><td <%=td_caption_bgcolor%>>Next In Sequence</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Sequence.Next_in_sequence", "raw", "SCRIPT:isValid(this,3)", "10"%></td></tr>
<%else%>
<tr><td <%=td_caption_bgcolor%>>Next In Sequence</td><td <%=td_bgcolor%>><%ShowInputField dbkey, formgroup,"Sequence.Next_in_sequence",  "3!1", "10"%></td></tr>
<%end if%>

<!--SYAN added on 5/27/2005 to fix CSBR-50860-->
<%'stop%>
<%if bUpdate = true then%>
<tr><td <%=td_caption_bgcolor%>>Salt Delimiter</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Sequence.REG_DELIMITER", "raw", "SCRIPT:checkForComma(this)", "1"%></td></tr>
<%else%>
<tr><td <%=td_caption_bgcolor%>>Salt Delimiter</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Sequence.REG_DELIMITER", "raw", "SCRIPT:checkForComma(this)", "1"%></td></tr>
<%end if%>

<%if bUpdate = true then%>
<tr><td <%=td_caption_bgcolor%>>Prefix Delimiter</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Sequence.PREFIX_DELIMITER", "raw", "SCRIPT:checkForComma(this)", "1"%></td></tr>
<%else%>
<tr><td <%=td_caption_bgcolor%>>Prefix Delimiter</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Sequence.PREFIX_DELIMITER", "raw", "SCRIPT:checkForComma(this)", "1"%></td></tr>
<%end if%>

<%if bUpdate = true then%>
<tr><td <%=td_caption_bgcolor%>>Root Number Length</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Sequence.ROOT_NUMBER_LENGTH", "raw", "SCRIPT:isValid(this,3)", "10"%></td></tr>
<%else%>
<tr><td <%=td_caption_bgcolor%>>Root Number Length</td><td <%=td_bgcolor%>><%ShowInputField dbkey, formgroup,"Sequence.ROOT_NUMBER_LENGTH",  "3!6", "10"%></td></tr>
<%end if%>



<!--End of SYAN modification-->

<tr><td <%=td_caption_bgcolor%>>Active</td><td <%=td_bgcolor%>><%ShowLookUpList dbkey, formgroup,BaseRS,"Sequence.Active", ActiveFlag_LIST,  ActiveFlag_VAL,ActiveFlag_TEXT,0,false,"value","1"%></td></tr>
</table>

<%Case "COMPOUND_TYPE"%>
<table border = 0>
<script language="javascript">
	required_fields="Compound_Type.Description;0:Structure comment"
</script>
<%if bUpdate = true then%>
<tr><td <%=td_caption_bgcolor%>>ID</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Compound_Type.Compound_type", "raw_no_edit",  "isValid(this,22)", "30"%></td></tr>
<%end if%>
<tr><td <%=td_caption_bgcolor%>>Stucture Comment</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"Compound_Type.Description", "raw",  "0", "50:500"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Active</td><td <%=td_bgcolor%>><%ShowLookUpList dbkey, formgroup,BaseRS, "Compound_Type.Active", ActiveFlag_LIST,  ActiveFlag_VAL,ActiveFlag_TEXT,0,false,"value","1" %></td></tr>
</table>
<%Case "PEOPLE"%>
<table border = 0>
<%if bUpdate = true then%>
<tr><td <%=td_caption_bgcolor%>>ID</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"People.Person_ID", "raw_no_edit", "isValid(this,22)", "30"%></td></tr>
<%end if%>
<%if bEditWG = true or bEditUserID=false then %>
<tr><td <%=td_caption_bgcolor%>>Chemist Code</td><td <%=td_bgcolor%>><%=BaseRS("User_Code")%></td></tr>
<%else%>
<tr><td <%=td_caption_bgcolor%>>Chemist Code</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"People.User_Code", "raw", "0", "30:50"%></td></tr>
<%end if%>
<%if bAdd = True then%>
<tr><td <%=td_caption_bgcolor%>>Unbound User_ID</td><td><%
ShowLookUpList dbkey, formgroup,BaseRS,"People.User_ID",Lookup_People_UserID_LIST, Lookup_People_UserID_VAL,Lookup_People_UserID_TEXT,0,false,"value","Login Disabled"%></td></tr>
<%else%>
<%if bEditWG = true  or bEditUserID=false then%>
	<tr><td <%=td_caption_bgcolor%>>User_ID</td><td <%=td_bgcolor%>><%=Lookup_People_UserID_TEXT%></td></tr>
<%else%>
	<tr><td <%=td_caption_bgcolor%>>User_ID</td><td <%=td_bgcolor%>><%ShowLookUpList dbkey, formgroup,BaseRS,"People.User_ID",Lookup_People_UserID_LIST, Lookup_People_UserID_VAL,Lookup_People_UserID_TEXT,0,false,"value","Login Disabled"%></td></tr>
<%end if%>
<%end if%>

<%if bEditWG=true or bEditUserID=true then%>
<%supervisor_id=basers("supervisor_internal_id")
supervisor_id_TEXT = getValueFromTablewConn(DataConn,"People", "person_id", supervisor_id, "User_ID")%>	
 <tr><td <%=td_caption_bgcolor%>>Supervisor/Workgroup ID</td><td <%=td_bgcolor%>><%ShowLookUpList dbkey, formgroup,BaseRS,"People.Supervisor_Internal_ID", Lookup_People_Person_ID_LIST,  supervisor_id,supervisor_id_TEXT,0,false,"value","1"%></td></tr>

<%else%>
 <tr><td <%=td_caption_bgcolor%>>Supervisor/Workgroup ID</td><td <%=td_bgcolor%>><%=supervisor_id_TEXT%></td></tr>

 <%end if%>
<%if bEditWG=true or bEditUserID=false then%>
<tr><td <%=td_caption_bgcolor%>>First Name</td><td <%=td_bgcolor%>><%= BaseRS("First_Name")%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Middle Name</td><td <%=td_bgcolor%>><%=BaseRS("Middle_Name")%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Last Name</td><td <%=td_bgcolor%>><%=BaseRS("Last_Name")%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Site</td><td <%=td_bgcolor%>><%=Lookup_Site_Site_ID_TEXT%></td></tr>
</td></tr>

<tr><td <%=td_caption_bgcolor%>>Telephone</td><td <%=td_bgcolor%>><%=BaseRS("Telephone")%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Email</td><td <%=td_bgcolor%>><%=BaseRS("Email")%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Active</td><td <%=td_bgcolor%>><%=ActiveFlag_TEXT%></td></tr>

</table>
<%else%>
<tr><td <%=td_caption_bgcolor%>>Supervisor/Workgroup ID</td><td <%=td_bgcolor%>><%ShowLookUpList dbkey, formgroup,BaseRS,"People.Supervisor_Internal_ID", Lookup_People_Person_ID_LIST,  Lookup_People_Person_ID_VAL,Lookup_People_Person_ID_TEXT,0,false,"value","1"%></td></tr>

<tr><td <%=td_caption_bgcolor%>>First Name</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"People.First_Name", "raw", "0", "30:50"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Middle Name</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"People.Middle_Name", "raw", "0", "30:50"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Last Name</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"People.Last_Name", "raw", "0", "30:50"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Site</td><td <%=td_bgcolor%>><%ShowLookUpList dbkey, formgroup,BaseRS,"People.Site_ID",Lookup_Site_Site_ID_LIST,  Lookup_Site_Site_ID_VAL,Lookup_Site_Site_ID_TEXT,0,false,"value","1"%></td></tr>
</td></tr>

<tr><td <%=td_caption_bgcolor%>>Telephone</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"People.Telephone", "raw", "0", "30:50"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Email</td><td <%=td_bgcolor%>><%ShowResult dbkey, formgroup, BaseRS,"People.Email", "raw", "0", "30:50"%></td></tr>
<tr><td <%=td_caption_bgcolor%>>Active</td><td <%=td_bgcolor%>><%ShowLookUpList dbkey, formgroup,BaseRS,"People.Active",ActiveFlag_LIST,  ActiveFlag_VAL,ActiveFlag_TEXT,0,false,"value","1"%></td></tr>

</table>

<%
end if
End Select

'if err.number > 0 then Response.Write err.description%>

<!--#INCLUDE VIRTUAL ="/cfserverasp/source/recordset_footer_vbs.asp"-->
</body>
</html>