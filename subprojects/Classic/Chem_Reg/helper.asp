<%@ Language=VBScript %>
<%Response.Expires=0
'Copyright 1999-2003 CambridgeSoft Corporation. All rights reserved
'DO NOT EDIT THIS FILE%>
<HTML>
<HEAD>
<TITLE>Helper.asp</TITLE>

<!--#INCLUDE VIRTUAL = "/cfserverasp/source/server_const_vbs.asp"-->
<!--#INCLUDE VIRTUAL = "/cfserverasp/source/search_func_vbs.asp"-->
<%
on error resume next
dbkey = Request.QueryString("dbname")

formmode= session("formmode_loaded")
formgroup=Request.QueryString("formgroup")
action = Request.QueryString("action")
if dbkey = "" then 
	dbkey = "reg"
end if%>
<script language= "javascript">
if (!<%=Application("mainwindow")%>.mainFrame){
	var theWindow = <%=Application("mainwindow")%>
}
else{
	var theWindow = <%=Application("mainwindow")%>.mainFrame
}

var formmode = "<%=formmode%>"
if (formmode == ""){
	formmode = theWindow.formmode

}
</script>
<%Select Case UCase(action)
Case "GET_CHEMIST"

	theID = request.querystring("unique_id")
	rowid= Request.querystring("rowid")
	if theID <> "" then
		set DataConn = GetNewConnection(dbkey, formgroup,"base_connection")
		sql = "Select * from People Where Upper(user_code) ='" & Trim(UCase(theID)) & "'"
		
		set rs = DataConn.Execute(sql)
		if not (rs.eof and rs.bof)then
			theValue = rs("First_Name") & " " & rs("Middle_Name")& " " & rs("Last_Name")
			person_id = rs("person_id")
			closers(rs)
			
	if Not UCase(formgroup) = "BASE_FORM_GROUP" then%>
			
			<script language="javascript">
				if (formmode.toLowerCase() == "edit_record"){
				
					top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:Temporary_Structures.Scientist_ID'].value = "<%=person_id%>"
					top.frames['main'].document.cows_input_form.elements['Temporary_Structures.Chemist_Name'].value = "<%=theValue%>"
					theWindow.UpdateRelUpdateFields("UID.<%=rowid%>:Temporary_Structures.Scientist_ID")
					theWindow.UpdateTable_Row_IDS("UID.<%=rowid%>:Temporary_Structures.Scientist_ID")
					theWindow.UpdateTable_Names("UID.<%=rowid%>:Temporary_Structures.Scientist_ID")
					
				}
				else{
					if  ((formmode.toLowerCase()== "search")|| (formmode.toLowerCase()== "add_record")|| (formmode.toLowerCase()== "add_compounds")){
							top.frames['main'].document.cows_input_form.elements['Temporary_Structures.Scientist_ID'].value = "<%=person_id%>"
							top.frames['main'].document.cows_input_form.elements['Temporary_Structures.Chemist_Name'].value = "<%=theValue%>"
					}
				}
			</script>
			
			<%else%>
			<script language="javascript">
				if (formmode.toLowerCase() == "edit_record"){
					top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:Batches.Scientist_ID'].value = "<%=person_id%>"
					top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:Batches.Chemist_Name'].value = "<%=theValue%>"
					theWindow.UpdateRelUpdateFields("UID.<%=rowid%>:Batches.Scientist_ID")
					theWindow.UpdateTable_Row_IDS("UID.<%=rowid%>:Batches.Scientist_ID")
					theWindow.UpdateTable_Names("UID.<%=rowid%>:Batches.Scientist_ID")
				}
				else
				{
				
					if  ((formmode.toLowerCase()== "search")|| (formmode.toLowerCase()== "add_record")|| (formmode.toLowerCase()== "add_compounds")){
						top.frames['main'].document.cows_input_form.elements['Batches.Scientist_ID'].value = "<%=person_id%>"
						top.frames['main'].document.cows_input_form.elements['Batches.Chemist_Name'].value = "<%=theValue%>"
					}
				}
				
			</script>
				
			<%end if%>
		<%else
	if Not UCase(formgroup) = "BASE_FORM_GROUP" then%>
				<script language="javascript">
					if (formmode.toLowerCase() == "edit_record"){
						top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:Temporary_Structures.Scientist_ID'].value = ""
						top.frames['main'].document.cows_input_form.elements['Temporary_Structures.Chemist_Code'].value = ""
						top.frames['main'].document.cows_input_form.elements['Temporary_Structures.Chemist_Name'].value = ""
						alert("invalid Sci. Code")
					}
					else{
						if  ((formmode.toLowerCase()== "search")|| (formmode.toLowerCase()== "add_record")|| (formmode.toLowerCase()== "add_compounds")){
							top.frames['main'].document.cows_input_form.elements['Temporary_Structures.Scientist_ID'].value = ""
							top.frames['main'].document.cows_input_form.elements['Temporary_Structures.Chemist_Code'].value = ""
							top.frames['main'].document.cows_input_form.elements['Temporary_Structures.Chemist_Name'].value = ""
							alert("invalid Sci. Code")
						}
					
					}
				</script>
				<%else%>
				<script language="javascript">
					if (formmode.toLowerCase() == "edit_record"){
						top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:Batches.Scientist_ID'].value = ""
						top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:Batches.Chemist_Code'].value = ""
						top.frames['main'].document.cows_input_form.elements[UID.<%=rowid%>:'Batches.Chemist_Name'].value = ""
						alert("invalid Sci. Code")
					}
					else{
						if  ((formmode.toLowerCase()== "search")|| (formmode.toLowerCase()== "add_record")|| (formmode.toLowerCase()== "add_compounds")){
							top.frames['main'].document.cows_input_form.elements['Batches.Scientist_ID'].value = ""
							top.frames['main'].document.cows_input_form.elements['Batches.Chemist_Code'].value = ""
							top.frames['main'].document.cows_input_form.elements['Batches.Chemist_Name'].value = ""
							alert("invalid Sci. Code")
						}
					}
				</script>
			<%end if
		end if
		closeconn(dataconn)

		
		end if
Case "GET_PRODUCER"
	theID = request.querystring("unique_id")
	rowid = request.querystring("rowid")
	if theID <> "" then
	
		set DataConn = GetNewConnection(dbkey, formgroup,"base_connection")
		sql = "Select * from People Where Upper(user_code) ='" & Trim(UCase(theID)) & "'"
		
		set rs = DataConn.Execute(sql)
		if not (rs.eof and rs.bof)then
		
			theValue = rs("First_Name") & " " & rs("Middle_Name")& " " & rs("Last_Name")
			person_id = rs("person_id")
			closers(rs)
	if Not UCase(formgroup) = "BASE_FORM_GROUP" then%>
			
			<script language="javascript">
				
				if (formmode.toLowerCase() == "edit_record"){
					top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:Temporary_Structures.<%=UCase(Application("producer_id_field"))%>'].value = "<%=person_id%>"
					top.frames['main'].document.cows_input_form.elements['Temporary_Structures.Producer_Name'].value = "<%=theValue%>"
				}
				else{
					if  ((formmode.toLowerCase()== "search")|| (formmode.toLowerCase()== "add_record")|| (formmode.toLowerCase()== "add_compounds")){
							top.frames['main'].document.cows_input_form.elements['TEMPORARY_STRUCTURES.<%=UCase(Application("producer_id_field"))%>'].value = "<%=person_id%>"
						
							top.frames['main'].document.cows_input_form.elements['Temporary_Structures.Producer_Name'].value = "<%=theValue%>"
					}
				}
			</script>
			<%else%>
			<script language="javascript">
				if (formmode.toLowerCase() == "edit_record"){
					top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:Batches.<%=UCase(Application("producer_id_field"))%>'].value = "<%=person_id%>"
					top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:Batches.Producer_Name'].value = "<%=theValue%>"
				}
				else{
					if  ((formmode.toLowerCase()== "search")|| (formmode.toLowerCase()== "add_record")|| (formmode.toLowerCase()== "add_compounds")){
						top.frames['main'].document.cows_input_form.elements['BATCHES.<%=UCase(Application("producer_id_field"))%>'].value = "<%=person_id%>"
						top.frames['main'].document.cows_input_form.elements['Batches.Producer_Name'].value = "<%=theValue%>"
					}
				}
			</script>
			<%end if%>
		<%else
			if Not UCASE(formgroup) = "BASE_FORM_GROUP" then%>
				<script language="javascript">
					if (formmode.toLowerCase() == "edit_record"){
						top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:Temporary_Structures.<%=UCase(Application("producer_id_field"))%>'].value = ""
						top.frames['main'].document.cows_input_form.elements['Temporary_Structures.Producer_Code'].value = ""
						top.frames['main'].document.cows_input_form.elements['Temporary_Structures.Producer_Name'].value = ""
						alert("invalid Prod. Code")
					}
					else{
						if  ((formmode.toLowerCase()== "search")|| (formmode.toLowerCase()== "add_record")|| (formmode.toLowerCase()== "add_compounds")){
								
								top.frames['main'].document.cows_input_form.elements['TEMPORARY_STRUCTURES.<%=UCase(Application("producer_id_field"))%>'].value = "<%=person_id%>"
								
							top.frames['main'].document.cows_input_form.elements['Temporary_Structures.Producer_Code'].value = ""
							top.frames['main'].document.cows_input_form.elements['Temporary_Structures.Producer_Name'].value = ""
							alert("invalid Prod. Code")
						}
					
					}
				</script>
				<%else%>
				<script language="javascript">
					if (formmode.toLowerCase() == "edit_record"){
						top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:Batches.<%=UCase(Application("producer_id_field"))%>'].value = ""
						top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:Batches.Producer_Code'].value = ""
						top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:Batches.Producer_Name'].value = ""
						alert("invalid Prod. Code")
					}
					else{
						if  ((formmode.toLowerCase()== "search")|| (formmode.toLowerCase()== "add_record")|| (formmode.toLowerCase()== "add_compounds")){
							top.frames['main'].document.cows_input_form.elements['BATCHES.<%=UCase(Application("producer_id_field"))%>'].value = ""
							top.frames['main'].document.cows_input_form.elements['Batches.Producer_Code'].value = ""
							top.frames['main'].document.cows_input_form.elements['Batches.Producer_Name'].value = ""
							alert("invalid Prod. Code")
						}
					
					}
				</script>
			<%end if
		end if
		closeconn(dataconn)
	if Not UCase(formgroup) = "BASE_FORM_GROUP" then%>
	<script language="javascript">
		if(formmode.toLowerCase() == "edit_record"){
		
			top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:Temporary_Structures.<%=UCase(Application("producer_id_field"))%>'].value = "<%=person_id%>"
			top.frames['main'].document.cows_input_form.elements['Temporary_Structures.Producer_Name'].value = "<%=theValue%>"			
			theWindow.UpdateRelUpdateFields("UID.<%=rowid%>:Temporary_Structures.<%=UCase(Application("producer_id_field"))%>")
			theWindow.UpdateTable_Row_IDS("UID.<%=rowid%>:Temporary_Structures.<%=UCase(Application("producer_id_field"))%>")
			theWindow.UpdateTable_Names("UID.<%=rowid%>:Temporary_Structures.<%=UCase(Application("producer_id_field"))%>")
			
		}
		
	</script>
	<%else%>
	<script language="javascript">
		if(formmode.toLowerCase() == "edit_record"){
		
			top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:Batches.<%=UCase(Application("producer_id_field"))%>'].value = "<%=person_id%>"
			top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:Batches.Producer_Name'].value = "<%=theValue%>"			
			theWindow.UpdateRelUpdateFields("UID.<%=rowid%>:Batches.<%=UCase(Application("producer_id_field"))%>")
			theWindow.UpdateTable_Row_IDS("UID.<%=rowid%>:Batches.<%=UCase(Application("producer_id_field"))%>")
			theWindow.UpdateTable_Names("UID.<%=rowid%>:Batches.<%=UCase(Application("producer_id_field"))%>")
		}
	</script>
		<%end if
		
	end if
'start GIV evscreen customization
Case "GET_INITIATOR"
	theID = request.querystring("unique_id")
	rowid = request.querystring("rowid")
	if theID <> "" then
	
		set DataConn = GetNewConnection(dbkey, formgroup,"base_connection")
		sql = "Select * from People Where Upper(user_code) ='" & Trim(UCase(theID)) & "'"
		
		set rs = DataConn.Execute(sql)
		if not (rs.eof and rs.bof)then
		
			theValue = rs("First_Name") & " " & rs("Middle_Name")& " " & rs("Last_Name")
			person_id = rs("person_id")
			closers(rs)
			
	if Not UCase(formgroup) = "BASE_FORM_GROUP" then%>
			
			<script language="javascript">
		
				if (formmode.toLowerCase() == "edit_record"){
					top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:EVSCREEN.TEST_INITIATOR'].value = "<%=person_id%>"
					top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR_NAME'].value = "<%=theValue%>"
				}
				else{
						if  ((formmode.toLowerCase()== "search")|| (formmode.toLowerCase().indexOf("add")!= -1 )){
						
						top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR'].value = "<%=person_id%>"
						top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR_NAME'].value = "<%=theValue%>"
					}
				}
			</script>
			<%else%>
			<script language="javascript">
				if (formmode.toLowerCase() == "edit_record"){
					top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:EVSCREEN.TEST_INITIATOR'].value = "<%=person_id%>"
					top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR_NAME'].value = "<%=theValue%>"
				}
				else{
						if  ((formmode.toLowerCase()== "search")|| (formmode.toLowerCase().indexOf("add")!= -1 )){
						top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR'].value = "<%=person_id%>"
						top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR_NAME'].value = "<%=theValue%>"
					}
				}
			</script>
			<%end if%>
		<%else
			if Not UCASE(formgroup) = "BASE_FORM_GROUP" then%>
				<script language="javascript">
					if (formmode.toLowerCase() == "edit_record"){
						top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:EVSCREEN.TEST_INITIATOR'].value = ""
						top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR_CODE'].value = ""
						top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR_NAME'].value = ""
						alert("invalid Test Initiator Code")
					}
					else{
						if  ((formmode.toLowerCase()== "search")|| (formmode.toLowerCase().indexOf("add")!= -1 )){
							top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR'].value = ""
							top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR_CODE'].value = ""
							top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR_NAME'].value = ""
							alert("invalid Test Initiator Code")
						}
					
					}
				</script>
				<%else%>
				<script language="javascript">
					if (formmode.toLowerCase() == "edit_record"){
						top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:EVSCREEN.TEST_INITIATOR'].value = ""
						top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR_CODE'].value = ""
						top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR_NAME'].value = ""
						alert("invalid Test Initiator Code")
					}
					else{
						if  ((formmode.toLowerCase()== "search")|| (formmode.toLowerCase().indexOf("add")!= -1 )){
							top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR'].value = ""
							top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR_CODE'].value = ""
							top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR_NAME'].value = ""
							alert("invalid Test Initiator Code")
						}
					
					}
				</script>
			<%end if
		end if
		closeconn(dataconn)
	if Not UCase(formgroup) = "BASE_FORM_GROUP" then%>
	<script language="javascript">
		if(formmode.toLowerCase() == "edit_record"){
		
			top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:EVSCREEN.TEST_INITIATOR'].value = "<%=person_id%>"
			top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR_NAME'].value = "<%=theValue%>"			
			theWindow.UpdateRelUpdateFields("UID.<%=rowid%>:EVSCREEN.TEST_INITIATOR")
			theWindow.UpdateTable_Row_IDS("UID.<%=rowid%>:EVSCREEN.TEST_INITIATOR")
			theWindow.UpdateTable_Names("UID.<%=rowid%>:EVSCREEN.TEST_INITIATOR")
			
		}
		
	</script>
	<%else%>
	<script language="javascript">
		if(formmode.toLowerCase() == "edit_record"){
		
			top.frames['main'].document.cows_input_form.elements['UID.<%=rowid%>:EVSCREEN.TEST_INITIATOR'].value = "<%=person_id%>"
			top.frames['main'].document.cows_input_form.elements['EVSCREEN.TEST_INITIATOR_NAME'].value = "<%=theValue%>"			
			theWindow.UpdateRelUpdateFields("UID.<%=rowid%>:EVSCREEN.TEST_INITIATOR")
			theWindow.UpdateTable_Row_IDS("UID.<%=rowid%>:EVSCREEN.TEST_INITIATOR")
			theWindow.UpdateTable_Names("UID.<%=rowid%>:EVSCREEN.TEST_INITIATOR")
		}
	</script>
		<%end if
		
	end if
	'end GIV evscreen customization
Case Else

end select
%>
</HEAD>

<body <%=Application("BODY_BACKGROUND")%> bgProperties=fixed>
<P>&nbsp;</P>
</body>
</html>