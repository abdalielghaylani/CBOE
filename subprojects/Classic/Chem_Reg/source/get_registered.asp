<%@ LANGUAGE=VBScript %>
<%response.expires = 0
Response.Buffer = true
'Copyright 1999-2003 CambridgeSoft Corporation. All rights reserved
'DO NOT EDIT THIS FILE%>

<%	dbkey="reg"
if Not Session("UserValidated" & dbkey) = 1 then response.redirect "/" & Application("AppKey") & "/reg/mainpage.asp"%>
<html>

<head>

<!--#INCLUDE VIRTUAL = "/cfserverasp/source/cows_func_js.asp"-->
<!--#INCLUDE FILE = "secure_nav.asp"-->


<%commit_type = request.querystring("commit_type")
record_added = request.querystring("record_added")

reg_verified = request.querystring("reg_verified")
cpd_counter = request.querystring("cpd_counter")
dbkey = request.querystring("dbname")
formgroup = request.querystring("formgroup")
formmode="add_compounds"
formgroupflag="REG_TEMP"
RootNumExample = GetExample(dbkey, formgroup,"Root_Num")
RegNumExample = GetExample(dbkey, formgroup,"Reg_Num")
%>
<script language="javascript">


function doGetReg(){

		commit_type="<%=commit_type%>"
		dbname ="<%=dbkey%>"
		formgroup= "<%=formgroup%>"
		appname = "<%=Application("AppKey")%>"
		theValue = document.reg_number.reg_value.value
		if(theValue == ""){
			if (commit_type =="batch_commit"){
				alert('please enter a full registry number (for example "<%=RegNumExample%>")')}
			if (commit_type =="add_identifiers"){
				alert('please enter a full registry number(for example "<%=RegNumExample%>")')}
			if (commit_type =="add_salt"){
				alert('please enter a parent number (for example, "<%=RootNumExample%>")')}
			if (commit_type =="add_analytics_data"){
				var regNum = '<%=RootNumExample%>'
				var batchNum = '<%=padNumber(Application("BATCH_NUMBER_LENGTH_GUI"),"1")%>'
				alert('please enter a parent number and batch number (for example,' + regNum + '/' + batchNum )}
			//Start Giv EVAL customization
			if (commit_type =="add_eval_data"){
				alert('please enter a parent number and batch number (for example, "<%=RootNumExample%>/001")')}
				}
			//End Givaudan EVAL customization
		else{
			document.forms["reg_number"].action = '/<%=Application("AppKey")%>/reg/reg_action.asp' + '?commit_type=' + commit_type + '&dataaction=get_registry_number' + '&dbname=' + 'reg' + '&formgroup=' + formgroup
			window.document.forms["reg_number"].submit()
		}
}

</script>

<title></title>
</head>
<%

if commit_type = "batch_commit" and record_added = "true" then%>
<script language="javascript">
//alert("A batch was added to the temporary table for later review.")
</script>
<%end if
if commit_type = "add_identifiers" and record_added ="true" then%>
<script language="javascript">
	//identLocation = "<%=CBool(Application("Identifiers_To_Temp"))%>"
	//	if(identLocation.toLowerCase() == "true"){
		//	alert("Identifiers were added to temporary table for later review.")
		//}
		//else{
			//alert("Identifiers were added to the permanent registry tables.")
		//}
</script>
<%End if
if commit_type = "add_salt" and cpd_counter = "all_available" then%>
<script
language="javascript">
	alert("All available salts are already registered for this compound.")
	</script>
<%
	
	Else
	if commit_type = "add_salt" and record_added = "true" then%>
<script language="javascript">
	//alert("A salt was added to temporary table for later review.")
	</script>
<%End if
end if

if commit_type = "add_analytics_data" and record_added = "true" then%>
<script language="javascript">
alert("Analytics data was added to the permanent registry tables.")
</script>
<%end if
'Start Givaudan EVAL customization

if commit_type = "add_eval_data" and cpd_counter = "eval_already_exists" then
%>
<script language="javascript">
alert("Fragrance Evaluation data already exists for the registration/batch entered.")
</script>
	<%Else
	if commit_type = "add_eval_data" and record_added = "true" then%>
<script language="javascript">
	alert("Fragrance Evaluation data was added to the permanent registry tables.")
	</script>
<%End if
end if
'end Givaudan EVAL customization%>


<body>
<!--#INCLUDE FILE = "app_vbs.asp"-->
<!--#INCLUDE VIRTUAL = "/cfserverasp/source/header_vbs.asp"-->
<!--#INCLUDE VIRTUAL = "/cfserverasp/source/input_form_footer_vbs.asp"-->
<form name="reg_number" action="/<%=Application("AppKey")%>/"reg/reg_action.asp" Method="Post" onsubmit="doGetReg()">
  <div align="center"><center><table border="0" width="358">
    <tr>
      <td width="354"><% select Case UCase(Commit_Type) 
		Case "BATCH_COMMIT"		
				if cpd_counter="dne" then
  					Response.Write "The registry number you entered does not exist, please try another." 
				else
  					 Response.Write "Please enter a full registry number for adding a new batch (for example, " & RegNumExample & ")" 
  				end if
		case "ADD_IDENTIFIERS" 
			if cpd_counter="dne" then 
				Response.Write "The registry number you entered does not exist, please try another." 
			else 
				Response.Write "Please enter a full registry number for adding identifiers (for example, " & RegNumExample & ")" 
			end if 
		Case "ADD_ANALYTICS_DATA"		
				if cpd_counter="dne" then
  					Response.Write "The registry number you entered does not exist, please try another." 
				else
  					 Response.Write "Please enter a parent number and batch number (for example, " & RegNumExample & "/" & padNumber(Application("BATCH_NUMBER_LENGTH_GUI"),"1") & ")" 
  				end if
  		'Start Givaudan EVAL customization
  		Case "ADD_EVAL_DATA"		
				if cpd_counter="dne" then
  					Response.Write "The registry number you entered does not exist, please try another." 
				else
  					Response.Write "Please enter a parent number and batch number (for example, " & RegNumExample  & "/" & padNumber(Application("BATCH_NUMBER_LENGTH_GUI"),"1") & ")" 
  				end if
  		'End Givaudan EVAL customization
		case "ADD_SALT" 
			if cpd_counter="dne" then 
				Response.Write "The registry number you entered does not exist, please try another." 
			else 
				Response.Write "Please enter a parent compound number for adding a salt (for example, " & RootNumExample & ")" 
			end if 
		
		End Select %>
<p><br>
      </p>
      <table border="0">
        <tr>
          <td>Registry Number:</td>
          <td><input type="text" name="reg_value" size="14"></td>
        </tr>
        <tr>
          <td></td>
          <td><a href="javascript:doGetReg()"><img src="/<%=Application("AppKey")%>/graphics/OK.gif" border="0" width="61"
          height="21"></a><a href="/<%=Application("AppKey")%>/reg/mainpage.asp?dbname=reg&formgroup=base_form_group" target="_top"><img
          src="/<%=Application("AppKey")%>/graphics/Cancel.gif" border="0" width="61" height="21"></a></td>
        </tr>
      </table>
      </td>
    </tr>
    <tr>
      <td width="354"></td>
    </tr>
    <tr>
      <td width="350" nowrap><div align="right"></div></td>
    </tr>
  </table>
  </center></div>
</form>
<script language="javascript">
	top.frames["navbar"].location.replace("/<%=Application("AppKey")%>/navbar.asp?nav_override=true&formmode=add_record&commit_type=" + "<%=commit_type%>")
</script>


</body>
</html>
