<!--#INCLUDE FILE = "../source/security_flags.asp"-->

<script language="javascript">
//Copyright 1999-2003 CambridgeSoft Corporation. All rights reserved

//DO NOT EDIT THIS FILE
//standard vars - do not edit
var AppKey = "<%=Application("AppKey")%>"
//!DGB! Change to accomodate additional frame inside main frame
	// if there is a frame called mainFrame inside the main it now becomes the
var MainWindow
if (!<%=Application("mainwindow")%>.mainFrame){
	MainWindow = <%=Application("mainwindow")%>
}
else{
	MainWindow = <%=Application("mainwindow")%>.mainFrame
}


//standard vars
var AppKey = "<%=Application("AppKey")%>"
MainWindow = <%=Application("mainwindow")%>
var commit_type = "<%=commit_type%>"
var formmode =  "<%=formmode%>"
var formgroupflag = "<%=formgroupflag%>"
var uniqueid = "<%=baseid%>"
var reg_status = "<%=record_registered%>"
var SHOW_SAR_TABLE = "<%=Application("SHOW_SAR_TABLE")%>"

//72137
//var duplicates_check = "<%=request("duplicates_check")%>"


//function getDuplicateWindow() {
//	var outputval = ""
//	if (duplicates_check.toLowerCase() == "true") {
//		alert('here');
//		duplicates_flag = "true";
//		outputval = outputval + getRegBtn_edit(uniqueid, commit_type, "text");
//	}
//}
//

function  getRegCommitButtons(){
	var outputval = ""
		
		var excludeButtonList = ""
		var button_override=MainWindow.button_override
		if (button_override.length > 0) {
			if (excludeButtonList.length>0){
				excludeButtonList = excludeButtonList + "," + button_override.toLowerCase()
			}
			else{
				excludeButtonList =  button_override.toLowerCase()
			}
		}

	
	isDone = "<%=request("done")%>"
	isDone = isDone.toLowerCase()
	
	//SYAN added on 12/9/2004 to fix CSBR-49587
	isApproveDone = "<%=request("approveDone")%>"
	isApproveDone = isApproveDone.toLowerCase()
	//End of SYAN modification
	
  //display approrpriate buttons depending on security flags
	if(formmode.toLowerCase() == "search"){
	}
	if(formmode.toLowerCase() == "edit"){
		

		if (bREGISTER_TEMP.toLowerCase() == "true") {
			
			if (isDone != "true"){
				if (regButtonOverride != true){
						if (excludeButtonList.indexOf("register") == -1) outputval = outputval + getRegBtn_edit(uniqueid, commit_type, "text");
					}
			}
			
			
		}
		outputval= outputval.replace("undefined", "")
		if ((commit_type.toLowerCase()=="batch_commit")&&((bEDIT_BATCH_TEMP.toLowerCase() == "true")||(bDELETE_TEMP.toLowerCase() == "true"))){
			if (isDone != "true"){
				if (editButtonOverride != true){
					if (excludeButtonList.indexOf("edit") == -1) outputval = outputval + getFormViewBtn("editTemp_btn.gif", "reg_ctrbt_commit_result_form.asp", "getBaseActualIndex", "edit_record", "text");
				}	
					
			}
		}
		if ((commit_type.toLowerCase()=="full_commit")&&((bEDIT_COMPOUND_TEMP.toLowerCase() == "true")||(bDELETE_TEMP.toLowerCase() == "true"))){
			if (isDone != "true"){
				if (editButtonOverride != true){
					if (excludeButtonList.indexOf("edit") == -1) outputval = outputval + getFormViewBtn("editTemp_btn.gif", "reg_ctrbt_commit_result_form.asp", "getBaseActualIndex", "edit_record", "text")
				}
			}	
		}		
		if ((commit_type.toLowerCase()=="add_identifiers")&&((bEDIT_IDENTIFIERS_TEMP.toLowerCase() == "true")||(bDELETE_TEMP.toLowerCase() == "true"))){
			if (isDone != "true"){
				if (editButtonOverride != true){
					if (excludeButtonList.indexOf("edit") == -1) outputval = outputval + getFormViewBtn("editTemp_btn.gif", "reg_ctrbt_commit_result_form.asp", "getBaseActualIndex", "edit_record", "text")
				}			
			}	
		}				
		if ((commit_type.toLowerCase()=="add_salt")&&((bEDIT_SALT_TEMP.toLowerCase() == "true")||(bDELETE_TEMP.toLowerCase() == "true"))){
			if (isDone != "true"){
				if (editButtonOverride != true){
					if (excludeButtonList.indexOf("edit") == -1) outputval = outputval + getFormViewBtn("editTemp_btn.gif", "reg_ctrbt_commit_result_form.asp", "getBaseActualIndex", "edit_record", "text")
				}			
			}	
		}	
		if(bDELETE_TEMP.toLowerCase() == "true"){
			if (isDone != "true"){
			
				if (deleteButtonOverride != true){
					if (excludeButtonList.indexOf("delete") == -1) outputval = outputval + '<a href="javascript:MainWindow.doDeleteRegister_edit()">'
					if (excludeButtonList.indexOf("delete") == -1) outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
				}
			}
		}
		
		//SYAN added on 12/8/2004 to fix CSBR-49587
		if((<%=Application("PRE_REGISTER_APPROVED_FLAG")%>== "1") && isApproveDone != "true"){
			if ((formgroup.toLowerCase()=="review_register_form_group") || (formgroup.toLowerCase()=="reg_ctrbt_commit_form_group")) {
				//SYAN added on 12/17/2004 to fix CSBR-50337
				if (bSET_APPROVED_FLAG.toLowerCase() == "true") {
					if (excludeButtonList.indexOf("approve") == -1) outputval = outputval + '<a href="javascript:MainWindow.doPreRegisterApproveSingle(uniqueid)">'
					if (excludeButtonList.indexOf("approve") == -1) outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/approve_btn.gif" BORDER="0"></a>'
				}
				//End of SYAN modification
			}
		}	
		//End of SYAN modification
	
	}
	
	if(formmode.toLowerCase() == "list"){
		var bOverrideRegAll = "<%=bOverrideRegAll%>"
		if (bREGISTER_TEMP.toLowerCase() == "true"){
		
			if ((bEDIT_SCOPE_ALL.toLowerCase() == "true") &&(bSITE_ACCESS_ALL.toLowerCase() == "true")){
			
				if ((isDone != "true")&& (fEmptyRecordset.toLowerCase() != "true")&&(formgroup.toLowerCase()=="reg_ctrbt_commit_form_group")){
				
					if (bOverrideRegAll.toLowerCase() == "false"){
						if (excludeButtonList.indexOf("register_all") == -1) outputval = outputval + '<a href="javascript:MainWindow.doRegister_All()">'
						if (excludeButtonList.indexOf("register_all") == -1) outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/register_all_btn.gif" BORDER="0"></a>'
					}
				}
				
			}	
			if ((isDone != "true")&& (fEmptyRecordset.toLowerCase() != "true") && ((formgroup.toLowerCase()=="reg_ctrbt_commit_user_form_group")||(formgroup.toLowerCase()=="review_register_form_group"))) {
				if (bOverrideRegAll.toLowerCase() == "false"){
					if (excludeButtonList.indexOf("register_all") == -1) outputval = outputval + '<a href="javascript:MainWindow.doRegister_All()">'
					if (excludeButtonList.indexOf("register_all") == -1) outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/register_all_btn.gif" BORDER="0"></a>'
				}
			}
			
			if ('<%=Session("MarkedHits" & dbkey & formgroup)%>' != '') {
        //SYAN modified on 1/10/2008 to fix CSBR-89864
        if ('<%=Application("MOLECULE_PROCESS")%>' == '1') {
          outputval = outputval + '<a href="javascript:MainWindow.doReApply_ChemScript_Rules()">'
				  outputval = outputval + 'Re-apply Rules</a>'
        }
        //End of SYAN modification
			}
			
			//SYAN added 10/19/2004 to fix CSBR-46772
			//SYAN modified on 11/20/2006 to fix CSBR-67006. Not tested because of Oracle hanging
			if (bDELETE_REG.toLowerCase()== "true" && excludeButtonList.indexOf("delete") == -1 && '<%=Session("MarkedHits" & dbkey & formgroup)%>' != '') {
				outputval = outputval + '<a href="javascript:MainWindow.doDelete_Marked_Temp()">'
				outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_marked_btn.gif" BORDER="0"></a>'
			}
			//End of SYAN modification
			
			//SYAN added on 12/8/2004 to fix CSBR-49587
			if((<%=Application("PRE_REGISTER_APPROVED_FLAG")%>== "1") && isApproveDone != "true"){
				if ((formgroup.toLowerCase()=="review_register_form_group") || (formgroup.toLowerCase()=="reg_ctrbt_commit_form_group")) {
					//SYAN added on 12/17/2004 to fix CSBR-50337
					if (bSET_APPROVED_FLAG.toLowerCase() == "true") {
						if (excludeButtonList.indexOf("approve_all") == -1) outputval = outputval + '<a href="javascript:MainWindow.doPreRegisterApproveAll()">'
						if (excludeButtonList.indexOf("approve_all") == -1) outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/approve_all_btn.gif" BORDER="0"></a>'
					}
					//End of SYAN modification
				}
			}
			//End of SYAN modification
			

		}
		
		
		
	}
	if(formmode.toLowerCase() == "edit_record"){
		outputval=""
		outputval = outputval + getButton("update_record")
		outputval = outputval + getButton("cancel_edit")
		
	}
	if(formmode.toLowerCase() == "add_record"){
	}
return outputval

}


function  getRegSearchButtons(){
	var outputval = ""
	var excludeButtonList = ""
		var button_override=MainWindow.button_override
		if (button_override.length > 0) {
			if (excludeButtonList.length>0){
				excludeButtonList = excludeButtonList + "," + button_override.toLowerCase()
			}
			else{
				excludeButtonList =  button_override.toLowerCase()
			}
		}
  //display approrpriate buttons depending on security flags
	if(formmode.toLowerCase() == "edit"){
		if ((bEDIT_SALT_REG.toLowerCase() == "true")||(bEDIT_IDENTIFIERS_REG.toLowerCase() == "true")||(bEDIT_COMPOUND_REG.toLowerCase() == "true")||(bEDIT_BATCH_REG.toLowerCase() == "true")){
		
			if (editButtonOverride != true){
				if (excludeButtonList.indexOf("edit") == -1) outputval = outputval + getFormViewBtn("editTemp_btn.gif", "reg_result_form.asp", "getBaseActualIndex", "edit_record", "text")
			}
			if (bADD_BATCH_TEMP.toLowerCase() == "true"){
			
				var Add_Batch_From_Reg_Results = "<%=Application("ADD_BATCH_FROM_REG_RESULTS")%>"
				if (Add_Batch_From_Reg_Results == "1") {
					var returnLocation= "/<%=Application("appkey")%>/reg/batch_ctrbt_form.asp?formmode=add_compounds&formgroup=batch_ctrbt_form_group&dbname=reg&commit_type=batch_commit&the_regnum_verified=true&the_reg_id=" + reg_id + "&cpd_counter=" + cpdDBCounter + "&batch_add_from_results=" + MainWindow.formgroup
					outputval = outputval + '<a href="' + returnLocation + '"target="main">'
					outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/add_batch.gif" BORDER="0"></a>'
				}
			}
		}	
		if((<%=Application("APPROVED_FLAG_USED")%>== "1") && (bSET_APPROVED_FLAG.toLowerCase() =="true")){
			if ((formgroup.toLowerCase()=="approve_form_group") && (approveButtonOverride == false)) {
				if (excludeButtonList.indexOf("approve") == -1) outputval = outputval + '<a href="javascript:MainWindow.doApproveSingle(uniqueid)">'
				if (excludeButtonList.indexOf("approve") == -1) outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/approve_btn.gif" BORDER="0"></a>'
			}
		}	
		
			
		if(bDELETE_REG.toLowerCase()== "true"){
			if (editButtonOverride != true){
				if (excludeButtonList.indexOf("delete") == -1) outputval = outputval + '<a href="javascript:MainWindow.doDeleteReg()">'
				if (excludeButtonList.indexOf("delete") == -1) outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
				
			}
		}		
		
	}
	if(formmode.toLowerCase() == "edit_record"){
		outputval = outputval + '<a href="javascript:MainWindow.doUpdateReg()">'
		outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/update_record_btn.gif" BORDER="0"></a>'
		outputval = outputval + getButton("cancel_edit")
		
	}
	
	if(formmode.toLowerCase() == "list"){
		if (SHOW_SAR_TABLE == 1){
			if (excludeButtonList.indexOf("sar_table") == -1) outputval = outputval + getFormViewBtn("show_sartable_btn.gif", "/<%=Application("appkey")%>/SARTable/SARTable_main.asp", "getBaseActualIndex", "sartable_list", "text","sartable_form_group&is_search=true")

		}
		if((<%=Application("APPROVED_FLAG_USED")%>== "1") && (bSET_APPROVED_FLAG.toLowerCase() =="true")){
			if (formgroup.toLowerCase()=="approve_form_group"){
				if (excludeButtonList.indexOf("approve_all") == -1) outputval = outputval + '<a href="javascript:MainWindow.doApproveAll()">'
				if (excludeButtonList.indexOf("approve_all") == -1) outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/approve_all_btn.gif" BORDER="0"></a>'
			}
		}

		
		//SYAN added 10/19/2004 to fix CSBR-46772
		if ( bDELETE_REG.toLowerCase()== "true" && excludeButtonList.indexOf("delete") == -1 && '<%=Session("MarkedHits" & dbkey & formgroup)%>' != '') {
			outputval = outputval + '<a href="javascript:MainWindow.doDelete_Marked_Perm()">'
			outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_marked_btn.gif" BORDER="0"></a>'
		}
		//End of SYAN modification
		
	}
	
	

return outputval

}

function  getRegManageTablesButtons(){

	var outputval = ""
  //display approrpriate buttons depending on security flags
	if(formmode.toLowerCase() == "search"){
	}
	if(formmode.toLowerCase() == "edit"){
		outputval = outputval +  getButton("new_search")
		outputval = outputval +  getButton("edit_search")
	}
	if(formmode.toLowerCase() == "list"){
		var limit_access = "<%=Request.QueryString("limit_access")%>"  
		var SHOW_SEC_TBLES_IN_USR_MGR="<%=Application("SHOW_SEC_TBLES_IN_USR_MGR")%>"
		if (limit_access.toUpperCase() != "WORKGROUP"){
			if (SHOW_SEC_TBLES_IN_USR_MGR == "1"){
				outputval = outputval +  getButton("new_search", "", "/chem_reg/graphics/ManageUsers_btn.gif")
			}
			else{
				outputval = outputval +  getButton("new_search", "", "/chem_reg/graphics/ManageTables_btn.gif")
			}
		}

	}
	if(formmode.toLowerCase() == "add_record"){
		table_name = "<%=Session("table_name")%>"
		
		outputval = outputval + getButton("add_record")
		outputval = outputval + '<a href="<%=Session("ListLocation" & dbkey & formgroup)%>" target = "main"><img SRC="/<%=Application("AppKey")%>/graphics/cancel_edit_btn.gif" BORDER="0"></a>'
		}
	
	if(formmode.toLowerCase() == "edit_record"){
	
		table_name = "<%=Session("table_name")%>"
		
			if ((table_name.toLowerCase() == "people") && ((bEDIT_PEOPLE_TABLE.toLowerCase()=="true")||(bEDIT_WORKGROUP.toLowerCase()=="true")||(bADD_WORKGROUP.toLowerCase()=="true"))){
				outputval = outputval + getButton("update_record")
			}
			if ((table_name.toLowerCase() == "people") && (bDELETE_PEOPLE_TABLE.toLowerCase()=="true")){
				//outputval = outputval + getButton("delete_record")
			}
		
			if ((table_name.toLowerCase() == "sites") && (bEDIT_SITES_TABLE.toLowerCase()=="true")){
			
				outputval = outputval + getButton("update_record")
				
			}
			if ((table_name.toLowerCase() == "sites") && (bDELETE_SITES_TABLE.toLowerCase()=="true")){
					outputval = outputval + '<a href="javascript:MainWindow.doDeleteSite('+ unique_id +')">'
					outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
			}
			outputval = outputval + '<a href="<%=Session("ListLocation" & dbkey & formgroup)%>" target = "main"><img SRC="/<%=Application("AppKey")%>/graphics/cancel_edit_btn.gif" BORDER="0"></a>'
			
			
	}


return outputval
	outputval = outputval + getButton("add_record")
}

function  getRegManageRegTablesButtons(){
	var outputval = ""
  //display approrpriate buttons depending on security flags
	var bPeopleProject = false
	var project_level_SECURITY= "<%=CBool(Application("PROJECT_LEVEL_ROW_SECURITY"))%>"

	if(formmode.toLowerCase() == "search"){
	}
	if(formmode.toLowerCase() == "edit"){
		outputval = outputval +  getButton("new_search")
		outputval = outputval +  getButton("edit_search")
	}
	if(formmode.toLowerCase() == "list"){
		outputval = outputval +  getButton("new_search", "", "/chem_reg/graphics/ManageTables_btn.gif")
	}
	if(formmode.toLowerCase() == "add_record"){
		table_name = "<%=Session("table_name")%>"
		if (table_name.toLowerCase() == "batch_projects") {
		
				outputval = outputval + '<a href="javascript:MainWindow.doAddBatch_Project()">'
				outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/add_record_btn.gif" BORDER="0"></a>'
		}else{
			if (table_name.toLowerCase() == "utilizations") {
		
				outputval = outputval + '<a href="javascript:MainWindow.doAddUtilization()">'
				outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/add_record_btn.gif" BORDER="0"></a>'
			}else{
				if ((table_name.toLowerCase() == "projects")&& (bMANAGE_PEOPLE_PROJECT.toLowerCase()=="true")&& (project_level_SECURITY.toLowerCase()== "true")){
					bPeopleProject = true
					outputval = outputval + '<a href="javascript:MainWindow.doAddPeople_Project()">'
					outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/add_record_btn.gif" BORDER="0"></a>'

				}else{
				outputval = outputval + getButton("add_record")
				}
			}
		}
		if (bPeopleProject == true){
			outputval = outputval + '<a href="<%=Session("ListLocation" & dbkey & formgroup)%>" target = "main"><img SRC="/<%=Application("AppKey")%>/graphics/cancel_edit_btn.gif" BORDER="0"></a>'
		}else{
		outputval = outputval + getButton("cancel_edit")
		}
		//outputval = outputval + getButton("clear_form")
		//outputval = outputval + getButton("restore_last")	
	}
	
	if(formmode.toLowerCase() == "edit_record"){
		table_name = "<%=Session("table_name")%>"
		
		var bRLS = "<%=Application("PROJECT_LEVEL_ROW_SECURITY")%>"
			if(bRLS=="1"){
				if ((table_name.toLowerCase() == "projects")&& (bMANAGE_PEOPLE_PROJECT.toLowerCase()=="true")&& (project_level_SECURITY.toLowerCase()== "true")){
					bPeopleProject = true
					outputval = outputval + '<a href="javascript:MainWindow.doUpdatePeople_Project('+ unique_id  +')">'
					outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/update_record_btn.gif" BORDER="0"></a>'
					if (unique_id!=1){
						outputval = outputval + '<a href="javascript:MainWindow.doDeletePeople_Project('+ unique_id +')">'
						outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
					}
				}

				if ((table_name.toLowerCase() == "projects") && (bEDIT_PROJECTS_TABLE.toLowerCase()=="true") && (bMANAGE_PEOPLE_PROJECT.toLowerCase()!="true")){
					
					outputval = outputval + getButton("update_record")
				}
				if ((table_name.toLowerCase() == "projects") && (bDELETE_PROJECTS_TABLE.toLowerCase()=="true")&&(bMANAGE_PEOPLE_PROJECT.toLowerCase()!="true")){
						if (unique_id!=1){
							outputval = outputval + '<a href="javascript:MainWindow.doDeleteProject('+ unique_id +')">'
							outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
						}
				}
			}else{
				if ((table_name.toLowerCase() == "people") && ((bEDIT_PEOPLE_TABLE.toLowerCase()=="true")||(bEDIT_WORKGROUP.toLowerCase()=="true")||(bADD_WORKGROUP.toLowerCase()=="true"))){
				
						var override_update = "<%=Session("Edit_Users_Table" & dbkey)%>"
						var override_update_workgroup = "<%=Session("Edit_WorkGroup" & dbkey)%>"
						var limit_access = "<%=request("limit_access")%>"
						if ((override_update.toLowerCase() != "false") || ((override_update_workgroup !="true")&&(limit_access.toLowerCase() =="workgroup"))){
							outputval = outputval + getButton("update_record")
						}
					}


				if ((table_name.toLowerCase() == "projects") && (bEDIT_PROJECTS_TABLE.toLowerCase()=="true") ){
					
					outputval = outputval + getButton("update_record")
				}
				if ((table_name.toLowerCase() == "projects") && (bDELETE_PROJECTS_TABLE.toLowerCase()=="true")){
						if (unique_id!=1){
							outputval = outputval + '<a href="javascript:MainWindow.doDeleteProject('+ unique_id +')">'
							outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
						}
				}
		
			}
			
			if ((table_name.toLowerCase() == "compound_type") && (bEDIT_COMPOUND_TYPE_TABLE.toLowerCase()=="true")){
				outputval = outputval + getButton("update_record")
			}
			
			if ((table_name.toLowerCase() == "compound_type") && (bDELETE_COMPOUND_TYPE_TABLE.toLowerCase()=="true")){
					if (unique_id!=1){
						outputval = outputval + '<a href="javascript:MainWindow.doDeleteCompoundType('+ unique_id +')">'
						outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
					}
			}
			
			if ((table_name.toLowerCase() == "notebooks") && (bEDIT_NOTEBOOKS_TABLE.toLowerCase()=="true")){
				outputval = outputval + getButton("update_record")
			}
			
			if ((table_name.toLowerCase() == "notebooks") && (bDELETE_NOTEBOOKS_TABLE.toLowerCase()=="true")){
				if (unique_id !=1){
					outputval = outputval + '<a href="javascript:MainWindow.doDeleteNotebook('+ unique_id +')">'
					outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
				}
			}
			if ((table_name.toLowerCase() == "sequence") && (bEDIT_SEQUENCES_TABLE.toLowerCase()=="true")){
				outputval = outputval + getButton("update_record")
			}
			if ((table_name.toLowerCase() == "sequence") && (bDELETE_SEQUENCES_TABLE.toLowerCase()=="true")){
					outputval = outputval + '<a href="javascript:MainWindow.doDeleteSequence('+ unique_id +')">'
					outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
			}
			if ((table_name.toLowerCase() == "sites") && (bEDIT_SITES_TABLE.toLowerCase()=="true")){
				outputval = outputval + getButton("update_record")
			}
			if ((table_name.toLowerCase() == "sites") && (bDELETE_SITES_TABLE.toLowerCase()=="true")){
					outputval = outputval + '<a href="javascript:MainWindow.doDeleteSite('+ unique_id +')">'
					outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
			}
			if ((table_name.toLowerCase() == "salts") && (bEDIT_SALT_TABLE.toLowerCase()=="true")){
				outputval = outputval + getButton("update_record")
			}
			if ((table_name.toLowerCase() == "salts") && (bDELETE_SALT_TABLE.toLowerCase()=="true")){
					if (unique_id !=1){
						outputval = outputval + '<a href="javascript:MainWindow.doDeleteSalt('+ unique_id +')">'
						outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
					}
			}
			if ((table_name.toLowerCase() == "solvates") && (bEDIT_SOLVATES_TABLE.toLowerCase()=="true")){
				outputval = outputval + getButton("update_record")
			}
			if ((table_name.toLowerCase() == "solvates") && (bDELETE_SOLVATES_TABLE.toLowerCase()=="true")){
				if (unique_id !=1){
					outputval = outputval + '<a href="javascript:MainWindow.doDeleteSolvate('+ unique_id +')">'
					outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
				}
			}
			
			if ((table_name.toLowerCase() == "utilizations") && (bEDIT_UTILIZATIONS_TABLE.toLowerCase()=="true")){
				
				outputval = outputval + '<a href="javascript:MainWindow.doUpdateUtilization('+ unique_id  +')">'
				outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/update_record_btn.gif" BORDER="0"></a>'
				}
			if ((table_name.toLowerCase() == "utilizations") && (bDELETE_UTILIZATIONS_TABLE.toLowerCase()=="true")){
				
				outputval = outputval + '<a href="javascript:MainWindow.doDeleteUtilization('+ unique_id +')">'
				outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
				}
			
		
			if ((table_name.toLowerCase() == "batch_projects") && (bEDIT_BATCH_PROJECTS_TABLE.toLowerCase()=="true")){
				
				outputval = outputval + '<a href="javascript:MainWindow.doUpdateBatch_Project('+ unique_id  +')">'
				outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/update_record_btn.gif" BORDER="0"></a>'
				}

			if ((table_name.toLowerCase() == "batch_projects") && (bDELETE_BATCH_PROJECTS_TABLE.toLowerCase()=="true")){
					
						outputval = outputval + '<a href="javascript:MainWindow.doDeleteBatch_Project('+ unique_id +')">'
						outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
					
				}
			
		if (bPeopleProject == true){
			outputval = outputval + '<a href="<%=Session("ListLocation" & dbkey & formgroup)%>" target = "main"><img SRC="/<%=Application("AppKey")%>/graphics/cancel_edit_btn.gif" BORDER="0"></a>'
		}else{
		outputval = outputval + getButton("cancel_edit")
		}
	}


return outputval

}

function  getAnalyticsButtons(){
	var outputval = ""
	indexValue = '<%=request.querystring("indexvalue")%>'
  //display approrpriate buttons depending on security flags
	
	if(formmode.toLowerCase() == "edit"){
		outputval = outputval + getFormViewBtn("return_to_details_btn.gif", "reg_result_form.asp", "getBaseActualIndex", "edit", "text","base_form_group")	
	}
	if(formmode.toLowerCase() == "manage_analytics"){
		if ((indexValue!= "")&& (indexValue !="0")){
			outputval = outputval + getFormViewBtn("return_to_details_btn.gif", "reg_result_form.asp", "getBaseActualIndex", "edit", "text","base_form_group")	
		}
	}
	
	

return outputval

}


function  getRegManageUsersButtons(){
	var outputval = ""
  //display approrpriate buttons depending on security flags
	if(formmode.toLowerCase() == "search"){
	}
	if(formmode.toLowerCase() == "edit_record"){
		outputval = '<a href="javascript:MainWindow.doUpdateUser(MainWindow.orig_current_list, MainWindow.orig_user_password, MainWindow.user_name)"><img'
		outputval = outputval + ' SRC="/<%=Application("AppKey")%>/graphics/update_user_btn.gif" BORDER="0"></a>'
		outputval = outputval + '<a href="javascript:MainWindow.doDeleteUser(MainWindow.user_name)"><img SRC="/<%=Application("AppKey")%>/graphics/delete_user_btn.gif" BORDER="0"></a>'
		outputval = outputval + '<a href="<%=Session("ListLocation" & dbkey & formgroup)%>" target = "main"><img SRC="/<%=Application("AppKey")%>/graphics/cancel_edit_btn.gif" BORDER="0"></a>'
		//outputval = outputval + getButton("cancel_edit")

	}
	if(formmode.toLowerCase() == "list"){
		outputval = outputval +  getButton("new_search","","/chem_reg/graphics/manage_users_btn.gif")
	}
	if(formmode.toLowerCase() == "add_record"){
		
		outputval = '<a href="javascript:MainWindow.submit_request(&quot;add_user&quot;,&quot;user_name:User Name,password:Password,password_confirmed:Password Confirm,roles_hidden:Role&quot;)">'
		outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/add_user_btn.gif" BORDER="0"></a>'
		outputval = outputval + '<a href="<%=Session("ListLocation" & dbkey & formgroup)%>" target = "main"><img SRC="/<%=Application("AppKey")%>/graphics/cancel_edit_btn.gif" BORDER="0"></a>'
   		
   		//outputval = outputval + getButton("cancel_edit")

	}
	
return outputval

}

function  getRegManagePasswordsButtons(){
	var outputval = ""
  //display approrpriate buttons depending on security flags
	if(formmode.toLowerCase() == "search"){
	}
	if(formmode.toLowerCase() == "edit_record"){
		outputval = '<a href="javascript:MainWindow.doUpdateUserPwd(MainWindow.orig_user_password, MainWindow.user_name)"><img'
		outputval = outputval + ' SRC="/<%=Application("AppKey")%>/graphics/update_user_btn.gif" BORDER="0"></a>'

		//outputval = outputval + getButton("cancel_edit")

	}
	if(formmode.toLowerCase() == "list"){
		outputval = outputval +  getButton("new_search")
	}
	if(formmode.toLowerCase() == "add_record"){
		
		outputval = '<a href="javascript:MainWindow.submit_request(&quot;add_user&quot;,&quot;user_name:User Name,password:Password,password_confirmed:Password Confirm,roles_hidden:Role&quot;)">'
		outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/add_user_btn.gif" BORDER="0"></a>'
		outputval = outputval + '<a href="<%=Session("ListLocation" & dbkey & formgroup)%>" target = "main"><img SRC="/<%=Application("AppKey")%>/graphics/cancel_edit_btn.gif" BORDER="0"></a>'
   		
   		//outputval = outputval + getButton("cancel_edit")

	}
	
return outputval

}

function  getRegManageRolesButtons(){
	var outputval = ""
  //display approrpriate buttons depending on security flags
	if(formmode.toLowerCase() == "search"){
	}
	if(formmode.toLowerCase() == "edit_record"){
		outputval = '<a href="javascript:MainWindow.doUpdateRole()"><img'
		outputval = outputval + ' SRC="/<%=Application("AppKey")%>/graphics/update_role_btn.gif" BORDER="0"></a>'
		//outputval = outputval + '<a href="javascript:MainWindow.doDeleteRole()"><img SRC="/<%=Application("AppKey")%>/graphics/delete_role_btn.gif" BORDER="0"></a>'
		//outputval = outputval + '<a href="<%=Session("ListLocation" & dbkey & formgroup)%>" target = "main"><img SRC="/<%=Application("AppKey")%>/graphics/cancel_edit_btn.gif" BORDER="0"></a>'
		outputval = outputval + getButton("cancel_edit")
	}
	if(formmode.toLowerCase() == "list"){
		outputval = outputval +  getButton("new_search","","/chem_reg/graphics/manage_users_btn.gif")
	}
	if(formmode.toLowerCase() == "add_record"){
		
		outputval = '<a href="javascript:MainWindow.doAddRole(MainWindow.role_name)">'
		outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/add_new_role_btn.gif" BORDER="0"></a>'
		//outputval = outputval + '<a href="<%=Session("ListLocation" & dbkey & formgroup)%>" target = "main"><img SRC="/<%=Application("AppKey")%>/graphics/cancel_edit_btn.gif" BORDER="0"></a>'
		outputval = outputval + getButton("cancel_edit")
	}
	
return outputval


}

function  getRegManageAnalyticsTablesButtons(){
	var outputval = ""
  //display approrpriate buttons depending on security flags
	if(formmode.toLowerCase() == "search"){
	}
	if(formmode.toLowerCase() == "edit"){
		outputval = outputval +  getButton("new_search")
		outputval = outputval +  getButton("edit_search")
	}
	if(formmode.toLowerCase() == "list"){
		var limit_access = "<%=Request.QueryString("limit_access")%>"  
		var limit_access = "<%=Session("access_override" & "experimenttype")%>" 
		if (limit_access.toUpperCase()!="ADD"){
			outputval = outputval +  getButton("new_search", "", "/chem_reg/graphics/manage_analytics_btn.gif")
		}
	}
	if(formmode.toLowerCase() == "add_record"){
		outputval = outputval + getButton("add_record")
		outputval = outputval + getButton("cancel_edit")
		outputval = outputval + getButton("clear_form")
		//outputval = outputval + getButton("restore_last")	
	}
	
	if(formmode.toLowerCase() == "edit_record"){
			outputval = outputval + getButton("update_record")
			outputval = outputval + getButton("cancel_edit")
			if (bDELETE_ANALYTICS_TABLES.toLowerCase() == "true"){
				outputval = outputval + getButton("delete_record")
				
			}
	}
	
	if(formmode.toLowerCase() == "ma_add"){
		var returnLoc = '<%=Session("MA_return_to")%>'
		outputval = outputval +  '<a href="JavaScript:MainWindow.location.replace(&quot;'+returnLoc+'&quot;)">'
		outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/return_to_details_btn.gif" BORDER="0"></a>'
		//outputval = outputval + getFormViewBtn("return_to_details_btn.gif", "/<%=Application("appkey")%>/admin/manage_analytics_tables/manage_analytic_tables_result_form.asp", "getBaseActualIndex", "LIST", "text","analytics_form_group")	
	}
	if(formmode.toLowerCase() == "ma_delete"){
		var returnLoc = '<%=Session("MA_return_to")%>'
		outputval = outputval +  '<a href="JavaScript:MainWindow.location.replace(&quot;'+returnLoc+'&quot;)">'
		outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/return_to_details_btn.gif" BORDER="0"></a>'
		//outputval = outputval + getFormViewBtn("return_to_details_btn.gif", "/<%=Application("appkey")%>/admin/manage_analytics_tables/manage_analytic_tables_result_form.asp", "getBaseActualIndex", "LIST", "text","analytics_form_group")	
	}
return outputval
}

function getMA_PaResButtons() {
	var outputval = ""
  //display appropriate buttons depending on action
	if(formmode.toLowerCase() == "ma_add"){
		var returnLoc = '<%=Session("MA_return_to")%>'
		outputval = outputval +  '<a href="JavaScript:MainWindow.location.replace(&quot;'+returnLoc+'&quot;)">'
		outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/return_to_details_btn.gif" BORDER="0"></a>'
		//outputval = outputval + getFormViewBtn("return_to_details_btn.gif", "/<%=Application("appkey")%>/admin/manage_analytics_tables/manage_analytic_tables_result_form.asp", "getBaseActualIndex", "EDIT_RECORD", "text","manage_analytics_tables_form_group")	
	}
	if(formmode.toLowerCase() == "ma_delete"){
		//outputval = outputval + getButton("return_to_list")
		var returnLoc = '<%=Session("MA_return_to")%>'
		outputval = outputval +  '<a href="JavaScript:MainWindow.location.replace(&quot;'+returnLoc+'&quot;)">'
		outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/return_to_details_btn.gif" BORDER="0"></a>'
		//outputval = outputval + getFormViewBtn("return_to_details_btn.gif", "/<%=Application("appkey")%>/admin/manage_analytics_tables/manage_analytic_tables_result_form.asp", "getBaseActualIndex", "EDIT_RECORD", "text","manage_analytics_tables_form_group")	
	}
return outputval
}

function  getRegTempButtons(){

	var outputval = ""
	var excludeButtonList = ""
		var button_override=MainWindow.button_override
		if (button_override.length > 0) {
			if (excludeButtonList.length>0){
				excludeButtonList = excludeButtonList + "," + button_override.toLowerCase()
			}
			else{
				excludeButtonList =  button_override.toLowerCase()
			}
		}

	if(formmode.toLowerCase() == "add_compounds"){
	
		var commit_type = "<%=request("commit_type")%>"
		var return_form = "<%=request("BATCH_ADD_FROM_RESULTS")%>"
		outputval = outputval + '<a href="javascript:MainWindow.doAddTemp()">'
		outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/add_record_btn.gif" BORDER="0"></a>'
		//outputval = outputval + getButton("cancel_edit")
		if (commit_type.toLowerCase() != "add_identifiers"){
			if (excludeButtonList.indexOf("clear_form") == -1) outputval = outputval + getButton("clear_form")
			}else{
			
			outputval = outputval +  '<a href="javascript:MainWindow.clearFormNP()">'
			outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/clear_form_btn.gif" BORDER="0"></a>'
			}
		if ((commit_type.toLowerCase() != "add_identifiers")&&(commit_type.toLowerCase() != "batch_commit")){
			if (excludeButtonList.indexOf("restore_last") == -1) outputval = outputval + getButton("restore_last")	
		}
		if(return_form !=""){
			var returnLoc = '<%=Session("PreBatchAddLocation"  & dbkey & request("BATCH_ADD_FROM_RESULTS"))%>'
			outputval = outputval + '<a href="JavaScript:MainWindow.location.replace(&quot;'+returnLoc+'&quot;)">'
			outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/cancel_edit_btn.gif" BORDER="0"></a>'
		}
	}
	if(formmode.toLowerCase() == "add_records"){
		
	
		outputval = outputval + '<a href="javascript:MainWindow.doAddTemp()">'
		outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/add_record_btn.gif" BORDER="0"></a>'
		//outputval = outputval + getButton("cancel_edit")
		if (excludeButtonList.indexOf("clear_form") == -1) outputval = outputval + getButton("clear_form")
		if (excludeButtonList.indexOf("restore_last") == -1) outputval = outputval + getButton("restore_last")	
	}
return outputval
}			
function getSARTableButtons(){
	var outputval = ""
		if(formmode.toLowerCase() == "sartable_list"){
			var returnLoc = '<%=Session("ListLocation" & dbkey & formgroup)%>'
			outputval = '<a href="JavaScript:MainWindow.location.replace(&quot;'+returnLoc+'&quot;)">'
			outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/return_to_details_btn.gif" BORDER="0"></a>'
		}
	return outputval
}

//function getOpenFileButton(){
		//var outputval = ""
		//var returnLoc = '<%=Session("ListLocation" & dbkey & formgroup)%>'
		//outputval = outputval + '<a href="javascript:MainWindow.doOpenFileLoadWindow()">'
		//outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/open_file_btn.gif" BORDER="0"></a>'
//return outputval
//}

function getBatchDeleteBtn(batch_id){
	var outputval = ""
	if (bDELETE_BATCH_REG.toLowerCase() == "true"){
			
			var returnLoc = '<%=Session("ListLocation" & dbkey & formgroup)%>'
			outputval = outputval + '<a href="javascript:MainWindow.doDeleteBatch(' + batch_id + ')">'
			outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
	}
	return outputval
}
function getDeleteExperimentBtn(experiment_id){
	var outputval = ""
	if (bDELETE_ANALYTICS.toLowerCase() == "true"){
			var returnLoc = '<%=Session("ListLocation" & dbkey & formgroup)%>'
			outputval = outputval + '<a href="javascript:MainWindow.doDeleteExperiment(' + experiment_id + ')">'
			outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
	}
	return outputval
}

function getDeleteAnalyticsBtn(batch_id){
	var outputval = ""
	
	if (bDELETE_ANALYTICS.toLowerCase() == "true"){
			var returnLoc = '<%=Session("ListLocation" & dbkey & formgroup)%>'
			outputval = outputval + '<a href="javascript:MainWindow.doDeleteAnalytics(' + batch_id + ')">'
			outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
	}
	return outputval
}
function getEditAnalyticsButtons(experiment_id, BaseID, form_referrer){
	var outputval = ""
	if (Edit_Analytics.toLowerCase()=="true"){
		var edit_analtyics_path="/<%=Application("appkey")%>/analytics/Analytics_editdata_form.asp?formmode=edit_record&formgroup=edit_analytics_form_group&dbname=<%=dbkey%>&commit_type=manage_analytics&experiment_id=" + experiment_id + '&BaseID=' + BaseID
		outputval = '<a href="' + edit_analtyics_path + '"target="main">'
		outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/edit_analytics_small_btn.gif" BORDER="0"></a>'
	}
return outputval
}
//Start Givaudan EVAL customization

var UPDATE_FRAG_EVAL_DATA = "<%=Session("UPDATE_FRAG_EVAL_DATA" & dbkey)%>"
var SELECT_FRAG_EVAL_DATA = "<%=Session("SELECT_FRAG_EVAL_DATA" & dbkey)%>"
var INSERT_FRAG_EVAL_DATA = "<%=Session("INSERT_FRAG_EVAL_DATA" & dbkey)%>"
var DELETE_FRAG_EVAL_DATA = "<%=Session("DELETE_FRAG_EVAL_DATA" & dbkey)%>"

function getAddEvalDataButtons(){

	var outputval = ""
	if (formmode.toLowerCase()== "add_eval_data2"){
		outputval = outputval + getFormViewBtn("return_to_details_btn.gif", "reg_result_form.asp", "getBaseActualIndex", "edit", "text","base_form_group")	
		
		outputval = outputval + '<a href="JavaScript:MainWindow.doAddEvalData()">'
		outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/add_record_btn.gif" BORDER="0"></a>'
		MainWindow.document.cows_input_form.return_location.value = '<%=Session("result_form_return_location")%>'
		outputval = outputval + getFormViewBtn("cancel_edit_btn.gif", "reg_result_form.asp", "getBaseActualIndex", "edit", "text","base_form_group")	
	}else {
		MainWindow.document.cows_input_form.return_location.value = "/chem_reg/source/get_registered.asp?nav_override=true&formmode=get_registered&formgroup=add_eval_data_form_group&dbname=reg&commit_type=add_eval_data&the_regnum_verified=false&record_added=true"
		outputval = '<a href="JavaScript:MainWindow.doAddEvalData()">'
		outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/add_record_btn.gif" BORDER="0"></a>'
		outputval = outputval + getButton("cancel_edit")
	}
	
	outputval = outputval + getButton("clear_form")
	
return outputval

}
function getAddEvalDataButtons2(){
 
	var outputval = ""
	outputval = outputval + getFormViewBtn("return_to_details_btn.gif", "reg_result_form.asp", "getBaseActualIndex", "edit", "text","base_form_group")	
	outputval = '<a href="JavaScript:MainWindow.doAddEvalData()">'
	outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/add_record_btn.gif" BORDER="0"></a>'
	outputval = outputval + getButton("cancel_edit")
	outputval = outputval + getButton("clear_form")
	if ((indexValue!= "")&& (indexValue !="0")){
		outputval = outputval + getFormViewBtn("return_to_details_btn.gif", "reg_result_form.asp", "getBaseActualIndex", "edit", "text","base_form_group")	
	}
	
return outputval

}


function getDeleteEvalDataBtn(evscreen_id){
	if (DELETE_FRAG_EVAL_DATA.toLowerCase()=="true"){
		var outputval = ""
			outputval = '<a href="JavaScript:MainWindow.doDeleteEvalData(' + evscreen_id+ ')">'
			outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
			document.write (outputval)
		
	}
}

function getEvalDataButtons(){

	var outputval = ""
	var indexValue = "<%=request.querystring("indexvalue")%>"
	var fromForm = "<%=request.querystring("fromForm")%>"
	var formmode =  "<%=request.querystring("formmode")%>"
	if (formmode.toLowerCase() == "eval_delete"){
		outputval = outputval + getFormViewBtn("return_to_details_btn.gif", "reg_result_form.asp", "getBaseActualIndex", "edit", "text","base_form_group")	
	}else{
		if ((indexValue!= "")&& (indexValue !="0")||(fromForm == "add_eval")){
			outputval = outputval + getFormViewBtn("return_to_details_btn.gif", "reg_result_form.asp", "getBaseActualIndex", "edit", "text","base_form_group")	
		}
	
		if (formmode.toLowerCase() == "edit_record"){
	
			outputval = outputval + getFormViewBtn("return_to_details_btn.gif", "reg_result_form.asp", "getBaseActualIndex", "edit", "text","base_form_group")	
			outputval = '<a href="JavaScript:MainWindow.doEditEvalData()">'
			
			outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/update_record_btn.gif" BORDER="0"></a>'
			if (DELETE_FRAG_EVAL_DATA.toLowerCase()=="true"){
				outputval = outputval + '<a href="JavaScript:MainWindow.doDeleteEvalData()">'
				outputval = outputval + '<img SRC="/<%=Application("AppKey")%>/graphics/delete_record_btn.gif" BORDER="0"></a>'
			}
			outputval = outputval + getButton("cancel_edit")
			
		}
		else
		{
			if (UPDATE_FRAG_EVAL_DATA.toLowerCase()=="true"){
				outputval = outputval + getButton("edit_record")
			}
		}
	}
return outputval

}

//End Givaudan EVAL customization

</script> 


