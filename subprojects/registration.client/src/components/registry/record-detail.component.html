<div class="viewcontainer" (window:resize)="onResize($event)" [hidden]="currentIndex!=0">
  <div *ngIf="submissionTemplatesEnabled" class="btn-group btn-group-xs pull-right" role="group" aria-label="" style="margin:5px">
    <button type="button" class="btn btn-default border-2 status background-blue border-blue">
      <i class="fa-undo white" aria-hidden="true"></i>
    </button>
    <button type="button" class="btn btn-default border-2 status border-blue blue dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Templates <span class="caret"></span></button>
    <ul class="dropdown-menu">
      <li><button type="button" class="btn" (click)="showSaveTemplate()">Save as Template</button></li>
      <li><button type="button" class="btn" (click)="showTemplates()">Load from Templates</button></li>
    </ul>
  </div>
  <command-button *ngIf="deleteButtonEnabled" testid="delete-record-details-button" (onClick)="delete()" iconName="trash" title="Delete"></command-button>
  <command-button *ngIf="editButtonEnabled" testid="edit-record-details-button" (onClick)="edit()" iconName="edit" title="Edit"></command-button>
  <command-button *ngIf="editMode &amp;&amp; !isNewRecord" testid="cancel-record-details-button" (onClick)="cancel()" iconName="undo" title="Cancel"></command-button>
  <command-button *ngIf="saveButtonEnabled" testid="save-record-details-button" (onClick)="save()" iconName="floppy-o" title="Save"></command-button>
  <command-button *ngIf="registerButtonEnabled" testid="register-record-details-button" (onClick)="register()" iconName="registered" title="Register"></command-button>
  <command-button *ngIf="approveButtonEnabled" testid="approve-temp-record-button" (onClick)="approve()" iconName="thumbs-o-up" title="Approve"></command-button>
  <command-button *ngIf="cancelApprovalButtonEnabled" testid="cancel-temp-record-approval-button" (onClick)="cancelApproval()" iconName="thumbs-o-down" title="Cancel Approval"></command-button>
  <reg-header testid="configuration-heading" id="qa-configuration-heading">
    {{title}}
  </reg-header>
  <dx-scroll-view id="detailScrollView" [height]="parentHeight" scrollByContent="true" scrollByThumb="true" showScrollbar="true">
    <form class="form-inline" role="form" ng-submit="search(query)">
      <div class="panel-group" id="accordion">
        <div class="panel panel-default">
          <div class="panel-heading" style='border-left: 4px solid tan;' (click)="togglePanel($event)">
            <a class="list-header tan" data-toggle="collapse" href="#structurePanel">Structure Information</a>
          </div>
          <div id="structurePanel" class="panel-collapse collapse in">
            <div class="panel-body">
              <div style="width:100%;height:100%;" resize>
                <chemdraw-web></chemdraw-web>
              </div>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading" style='border-left: 4px solid tan;' (click)="togglePanel($event)">
            <a class="list-header tan" data-toggle="collapse" href="#registryPanel">Registry Information</a>
          </div>
          <div id="registryPanel" class="panel-collapse collapse in">
            <div class="panel-body">
              <dx-form id="registryForm" [formData]="regRecordVM" [colCount]="2" [items]="regRecordVM.columns" [readOnly]="!editMode">
                <div *dxTemplate="let data of 'tagBoxTemplate'">
                  <reg-tag-box-form-item-template [editMode]="editMode" [data]="data"></reg-tag-box-form-item-template>
                </div>
                <div *dxTemplate="let data of 'dataGridTemplate'">
                  <reg-data-grid-form-item-template [editMode]="editMode" [data]="data"></reg-data-grid-form-item-template>
                </div>
              </dx-form>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading" style='border-left: 4px solid tan;' (click)="togglePanel($event)">
            <a class="list-header tan" data-toggle="collapse" href="#componentPanel">Component Information </a>
          </div>
          <div id="componentPanel" class="panel-collapse collapse in">
            <div class="panel-body">
              <dx-form id="componentForm" [formData]="regRecordVM.componentList[0]" [items]="regRecordVM.componentList[0].columns" [readOnly]="!editMode">
                <div *dxTemplate="let data of 'tagBoxTemplate'">
                  <reg-tag-box-form-item-template [editMode]="editMode" [data]="data"></reg-tag-box-form-item-template>
                </div>
                <div *dxTemplate="let data of 'dataGridTemplate'">
                  <reg-data-grid-form-item-template [editMode]="editMode" [data]="data"></reg-data-grid-form-item-template>
                </div>
              </dx-form>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading" style='border-left: 4px solid tan;' (click)="togglePanel($event)">
            <a class="list-header tan" data-toggle="collapse" href="#batchPanel">Batch Information </a>
          </div>
          <div id="batchPanel" class="panel-collapse collapse in">
            <div class="panel-body">
              <dx-form id="batchForm" [formData]="regRecordVM.batchList[0]" [items]="regRecordVM.batchList[0].columns" [readOnly]="!editMode">
                <div *dxTemplate="let data of 'tagBoxTemplate'">
                  <reg-tag-box-form-item-template [editMode]="editMode" [data]="data"></reg-tag-box-form-item-template>
                </div>
                <div *dxTemplate="let data of 'dataGridTemplate'">
                  <reg-data-grid-form-item-template [editMode]="editMode" [data]="data"></reg-data-grid-form-item-template>
                </div>
              </dx-form>
            </div>
          </div>
        </div>
      </div>
    </form>
  </dx-scroll-view>
  <dx-popup [width]="400" [height]="220" [showTitle]="true" title="Save as Template" [dragEnabled]="false" [closeOnOutsideClick]="true" [(visible)]="saveTemplatePopupVisible">
    <div *dxTemplate="let data of 'content'">
      <dx-form id="saveTemplateForm" labelLocation="left" minColWidth="400" [colCount]="1" [items]="saveTemplateItems" [formData]="saveTemplateData" (onInitialized)='onSaveTemplateFormInit($event)'>
        <div *dxTemplate="let data of 'tagBoxTemplate'">
          <reg-tag-box-form-item-template [editMode]="editMode" [data]="data"></reg-tag-box-form-item-template>
        </div>
        <div *dxTemplate="let data of 'dataGridTemplate'">
          <reg-data-grid-form-item-template [editMode]="editMode" [data]="data"></reg-data-grid-form-item-template>
        </div>
      </dx-form>
      <div style="margin-top: 15px">
        <button class="mr1 btn btn-primary" (click)="saveTemplate()">Save</button>
        <button class="mr1 btn btn-primary" (click)="cancelSaveTemplate()">Cancel</button>
      </div>
    </div>
  </dx-popup>
</div>
<div class="viewcontainer" [hidden]="currentIndex!=1">
  <reg-templates (onClose)="showDetails($event)"></reg-templates>
</div>
