<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="PerformSearch_files/filelist.xml">
<title>Introduction to COEFormGenerator</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>cgautam</o:Author>
  <o:Template>COE.dot</o:Template>
  <o:LastAuthor>cgautam</o:LastAuthor>
  <o:Revision>71</o:Revision>
  <o:TotalTime>130</o:TotalTime>
  <o:Created>2007-08-03T12:51:00Z</o:Created>
  <o:LastSaved>2007-10-16T12:11:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>659</o:Words>
  <o:Characters>3760</o:Characters>
  <o:Company>Q3 Technologies</o:Company>
  <o:Lines>31</o:Lines>
  <o:Paragraphs>8</o:Paragraphs>
  <o:CharactersWithSpaces>4411</o:CharactersWithSpaces>
  <o:Version>11.5606</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>90</w:Zoom>
  <w:DontDisplayPageBoundaries/>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:1627421319 -2147483648 8 0 66047 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-update:auto;
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
h1
	{mso-style-name:"Heading 1\,COEHeading 1";
	mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:17.0pt;
	mso-bidi-font-size:16.0pt;
	font-family:Arial;
	mso-font-kerning:16.0pt;
	font-weight:normal;}
h2
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:15.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:Arial;
	mso-bidi-font-style:italic;}
h3
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:13.0pt;
	font-family:Arial;}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-noshow:yes;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
span.MsoCommentReference
	{mso-style-noshow:yes;
	mso-ansi-font-size:8.0pt;
	mso-bidi-font-size:8.0pt;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{mso-style-noshow:yes;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	background:navy;
	font-size:10.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{mso-style-noshow:yes;
	mso-style-parent:"Comment Text";
	mso-style-next:"Comment Text";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-noshow:yes;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:8.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";}
p.COENormal, li.COENormal, div.COENormal
	{mso-style-name:COENormal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.COEHeading2, li.COEHeading2, div.COEHeading2
	{mso-style-name:"COEHeading 2";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:15.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.COEHeading3, li.COEHeading3, div.COEHeading3
	{mso-style-name:"COEHeading 3";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:13.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.COEHeading4, li.COEHeading4, div.COEHeading4
	{mso-style-name:"COEHeading 4";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.COEHeading5, li.COEHeading5, div.COEHeading5
	{mso-style-name:"COEHeading 5";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.Code, li.Code, div.Code
	{mso-style-name:Code;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
p.COEItemizedList, li.COEItemizedList, div.COEItemizedList
	{mso-style-name:COEItemizedList;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	mso-list:l1 level1 lfo2;
	tab-stops:list .5in;
	font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";}
p.COENumberedList, li.COENumberedList, div.COENumberedList
	{mso-style-name:COENumberedList;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	mso-list:l1 level2 lfo2;
	tab-stops:list .5in 1.0in;
	font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:99684089;
	mso-list-template-ids:745321182;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1
	{mso-list-id:107429549;
	mso-list-type:hybrid;
	mso-list-template-ids:-1652812798 1865571212 318550718 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-style-link:COEItemizedList;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l1:level2
	{mso-level-style-link:COENumberedList;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l1:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2
	{mso-list-id:1262571218;
	mso-list-template-ids:330585960;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3
	{mso-list-id:1919288245;
	mso-list-type:hybrid;
	mso-list-template-ids:-1137007994 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l3:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4
	{mso-list-id:2036152478;
	mso-list-type:hybrid;
	mso-list-template-ids:1875430846 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l4:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
table.MsoTableGrid
	{mso-style-name:"Table Grid";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	border:solid windowtext 1.0pt;
	mso-border-alt:solid windowtext .5pt;
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-border-insideh:.5pt solid windowtext;
	mso-border-insidev:.5pt solid windowtext;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Perform Search<o:p></o:p></b></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>The DoSearch() method of the COESearch class of
COESearchService<span style='mso-no-proof:yes'><span style='mso-spacerun:yes'> 
</span>performs a search operation using the provided XML files: DataView,
SearchCriteria, Results Criteria, and Paging Info. It also enables you to<span
style='mso-spacerun:yes'>  </span>specify whether you want to perform the
search with SearchCriteria or without SearchCriteria. The DoSearch() method
returns a SearchResponse object and it also calls the GetHitlist and GetData
methods.<o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='mso-no-proof:yes'>The DoSearch() method
contains the following parameters:<o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l3 level1 lfo5;tab-stops:list .5in'><span
     style='mso-no-proof:yes'>searchCriteria: Is the object of the
     SearchCriteria class.<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l3 level1 lfo5;tab-stops:list .5in'><span
     style='mso-no-proof:yes'>resultsCriteria: Is the object of the
     ResultsCriteria class.<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l3 level1 lfo5;tab-stops:list .5in'><span
     style='mso-no-proof:yes'>pagingInfo: Is the object of the PagingInfo
     class.<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l3 level1 lfo5;tab-stops:list .5in'><span
     style='mso-no-proof:yes'>dataView: Is the object of the DataView class.<o:p></o:p></span></li>
</ul>

<p class=MsoNormal style='margin-left:.25in'><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>The input XML files: Search Criteria, Results Criteria,
PagingInfo and Data View, need to be converted to their corresponding objects.
For example, the XML file for the Search Criteria needs to be converted to the
object of the SearchCriteria class.<span style='mso-spacerun:yes'>  </span></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>The following code snippet shows how to perform search
operation using the DoSearch() method:</p>

<p class=MsoNormal><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'>class PerformSearchTest<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>     </span><span style='color:teal'>COESearch</span>
_coeSearch = <span style='color:blue'>new</span> <span style='color:teal'>COESearch</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>     </span><span style='color:teal'>COEDataView</span>
dataView = <span style='color:blue'>new</span> <span style='color:teal'>COEDataView</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>     </span><span style='color:teal'>SearchCriteria</span>
searchCriteria = <span style='color:blue'>new</span> <span style='color:teal'>SearchCriteria</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>     </span><span style='color:teal'>ResultsCriteria</span>
resultsCriteria = <span style='color:blue'>new</span> <span style='color:teal'>ResultsCriteria</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>     </span><span style='color:teal'>PagingInfo</span>
pagingInfo = <span style='color:blue'>new</span> <span style='color:teal'>PagingInfo</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>     </span><span style='color:teal'>SearchResponse</span>
searchResponse = <span style='color:blue'>null</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span><span style='color:green'>// Paths to
xml files<o:p></o:p></span></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span><span style='color:blue'>string</span>
tempPath = <span style='color:teal'>Environment</span>.GetFolderPath(<span
style='color:teal'>Environment</span>.<span style='color:teal'>SpecialFolder</span>.LocalApplicationData)
+ <span style='color:maroon'>@&quot;\&quot;</span> + <span style='color:teal'>Application</span>.ProductName
+ <span style='color:maroon'>@&quot;\&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span><span style='color:blue'>public</span> <span
style='color:blue'>void</span> TestDoSearch(<span style='color:blue'>bool</span>
SendSearchCritera)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span><span style='color:green'>// Build
DataView<o:p></o:p></span></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>dataView = <span style='color:blue'>new</span>
<span style='color:teal'>COEDataView</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>BuildDataViewFromXML(<span
style='color:blue'>ref</span> dataView);<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span><span style='color:green'>// Build
SearchCriteria<o:p></o:p></span></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>             </span>searchCriteria = <span
style='color:blue'>new</span> <span style='color:teal'>SearchCriteria</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span><span style='mso-tab-count:1'>    </span><span
style='color:blue'>if</span> (!SendSearchCritera)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span><span style='mso-tab-count:1'>    </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span><span style='mso-tab-count:2'>            </span>searchCriteria
= <span style='color:blue'>null</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span><span style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>       </span><span style='mso-tab-count:1'>     </span><span
style='color:blue'>else<o:p></o:p></span></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span><span style='mso-tab-count:1'>    </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>          </span><span style='mso-tab-count:1'>  </span><span
style='mso-spacerun:yes'>  </span><span style='mso-tab-count:1'>    </span>BuildSearchCriteriaFromXML(<span
style='color:blue'>ref</span> searchCriteria);<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span><span style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span><span style='color:green'>// Build
ResultsCriteria<o:p></o:p></span></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>resultsCriteria = <span
style='color:blue'>new</span> <span style='color:teal'>ResultsCriteria</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>BuildResultsCriteriaFromXML(<span
style='color:blue'>ref</span> resultsCriteria);<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span><span style='color:green'>//PagingInfo<o:p></o:p></span></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>pagingInfo = <span
style='color:blue'>new</span> <span style='color:teal'>PagingInfo</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>BuildPagingInfoFromXML(<span
style='color:blue'>ref</span> pagingInfo);<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span><span style='color:blue'>try<o:p></o:p></span></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>                </span><span style='color:blue'>this</span>.Cursor
= <span style='color:teal'>Cursors</span>.WaitCursor;<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>                </span>searchResponse = <span
style='color:blue'>null</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:96.0pt;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:"Courier New";mso-no-proof:yes'>searchResponse
= _coeSearch.DoSearch(searchCriteria, resultsCriteria, pagingInfo, dataView);<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span><span style='color:blue'>catch</span>
(<span style='color:teal'>Exception</span> ex)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New";mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New";mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:"Courier New";color:blue;
mso-no-proof:yes'><span style='mso-spacerun:yes'>  </span>private</span><span
style='font-family:"Courier New";mso-no-proof:yes'> <span style='color:blue'>void</span>
BuildDataViewFromXML(<span style='color:blue'>ref</span> <span
style='color:teal'>COEDataView</span> dataView)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span><span style='color:teal'>XmlDocument</span>
doc = <span style='color:blue'>new</span> <span style='color:teal'>XmlDocument</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>doc.Load(tempPath +”DataView.xml”);<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>dataView = <span style='color:blue'>new</span>
<span style='color:teal'>COEDataView</span>(doc);<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New";mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:48.0pt;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:"Courier New";color:blue;
mso-no-proof:yes'>private</span><span style='font-family:"Courier New";
mso-no-proof:yes'> <span style='color:blue'>void</span>
BuildSearchCriteriaFromXML(<span style='color:blue'>ref</span> <span
style='color:teal'>SearchCriteria</span> searchCriteria)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span><span style='color:teal'>XmlDocument</span>
doc = <span style='color:blue'>new</span> <span style='color:teal'>XmlDocument</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>doc.Load(tempPath +
“SearchCriteria.xml”);<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span><span style='color:blue'>try<o:p></o:p></span></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>                </span>searchCriteria = <span
style='color:blue'>new</span> <span style='color:teal'>SearchCriteria</span>(doc);<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span><span style='color:blue'>catch</span>
(<span style='color:teal'>Exception</span> ex)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>               </span><span
style='mso-spacerun:yes'> </span>HandleException(ex);<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New";mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:48.0pt;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:"Courier New";color:blue;
mso-no-proof:yes'>private</span><span style='font-family:"Courier New";
mso-no-proof:yes'> <span style='color:blue'>void</span>
BuildResultsCriteriaFromXML(<span style='color:blue'>ref</span> <span
style='color:teal'>ResultsCriteria</span> resultsCriteria)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span><span style='color:teal'>XmlDocument</span>
doc = <span style='color:blue'>new</span> <span style='color:teal'>XmlDocument</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>doc.Load(tempPath +
“ResultCriteria.xml”);<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>resultsCriteria = <span
style='color:blue'>new</span> <span style='color:teal'>ResultsCriteria</span>(doc);<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span><span style='color:blue'>private</span>
<span style='color:blue'>void</span> BuildPagingInfoFromXML(<span
style='color:blue'>ref</span> <span style='color:teal'>PagingInfo</span>
pagingInfo)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span>{<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span><span style='color:teal'>XmlDocument</span>
doc = <span style='color:blue'>new</span> <span style='color:teal'>XmlDocument</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>doc.Load(tempPath +
“PagingInfo.xml”);<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>            </span>pagingInfo = <span
style='color:blue'>new</span> <span style='color:teal'>PagingInfo</span>(doc);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New";mso-no-proof:yes'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New";mso-no-proof:yes'>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New";mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>The above code snippet defines PerformSearchTest class that
contains the following methods to perform the search operation:</p>

<p class=MsoNormal><span style='font-family:"Courier New";mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l4 level1 lfo8;tab-stops:list .5in'>TestDoSearch:
     This method calls the GetData() method of the COESearch class of the COESearchService,
     which returns a dataset containing the desired data. </li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo8;tab-stops:list .5in'>BuildDataViewFromXML:
     This method converts the DataView XML into the DataView object.</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo8;tab-stops:list .5in'>BuildSearchCriteriaFromXML:
     This method converts the SearchCriteria XML into the SearchCriteria object</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo8;tab-stops:list .5in'>BuildResultsCriteriaFromXML:
     This method converts the SearchCriteria XML into the ResultsCriteria
     object.</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo8;tab-stops:list .5in'>BuildPagingInfoFromXML:
     This method converts the PagingInfo XML into the PagingInfo object. </li>
</ul>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
